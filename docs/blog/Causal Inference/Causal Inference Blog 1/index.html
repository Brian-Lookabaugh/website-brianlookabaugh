<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.120">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Brian Lookabaugh">
<meta name="dcterms.date" content="2023-02-11">
<meta name="description" content="An introduction to the world of causal inference for the casual, curious reader.">

<title>Brian Lookabaugh - Causal Inference for Casuals, Part I</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../images/sticker.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../images/sticker.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Brian Lookabaugh</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../resume/index.html">Resume</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../projects/index.html">Projects</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../blog/index.html">Blog</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/brian-lookabaugh-372ab31a1/"><i class="bi bi-linkedin" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Brian-Lookabaugh"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:brianlookabaughjr@gmail.com"><i class="bi bi-envelope" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#the-state-of-science" id="toc-the-state-of-science" class="nav-link active" data-scroll-target="#the-state-of-science">The State of Science</a></li>
  <li><a href="#the-promise-and-pitfalls-of-the-rct" id="toc-the-promise-and-pitfalls-of-the-rct" class="nav-link" data-scroll-target="#the-promise-and-pitfalls-of-the-rct">The Promise and Pitfalls of the RCT</a></li>
  <li><a href="#the-causal-revolution" id="toc-the-causal-revolution" class="nav-link" data-scroll-target="#the-causal-revolution">The Causal Revolution</a></li>
  <li><a href="#potential-outcomes" id="toc-potential-outcomes" class="nav-link" data-scroll-target="#potential-outcomes">Potential Outcomes</a></li>
  <li><a href="#recommended-materials" id="toc-recommended-materials" class="nav-link" data-scroll-target="#recommended-materials">Recommended Materials</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Causal Inference for Casuals, Part I</h1>
<p class="subtitle lead">What Is Causal Inference and Why Does It Matter?</p>
  <div class="quarto-categories">
    <div class="quarto-category">causal inference</div>
    <div class="quarto-category">DAGs</div>
    <div class="quarto-category">potential outcomes</div>
  </div>
  </div>

<div>
  <div class="description">
    An introduction to the world of causal inference for the casual, curious reader.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Brian Lookabaugh </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 11, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="the-state-of-science" class="level3">
<h3 class="anchored" data-anchor-id="the-state-of-science">The State of Science</h3>
<p>“Science” and scientific articles are often used in a variety of contexts to prove a point. Perhaps you are arguing with your uncle at the Thanksgiving dinner table over the effectiveness of government welfare programs and cite an academic article to prove your point. Perhaps you have seen a talk show personality on a cable news network cite a “recent study” that somehow “proves” a relationship between two variables that happens to align with the ideological character of said news network. Maybe you’ve cited a study or two in a paper for college on a topic that interested you to support your point. It often feels that our claims are more authoritative when we add some citations in parentheses to the end of our sentences, ex. “(Smith 2010, Williamson and Baker 2013)”.</p>
<p>As it turns out, most scientific articles do not accomplish what the layman thinks they do. For someone on the outside looking, science is all about “proving” things. “They have actually proven that X causes Y to happen”. (That is, the average person thinks that most science engages in “causal inference”, the process through which researchers are able to isolate the specific effect that a certain variable (X) has on a certain outcome (Y)). I have heard these phrases from a variety of people I know in my personal life more times than I can count. I am not sure who “they” is, but I am willing to bet that “their” study likely did nothing more than establish a potentially fragile correlation and estimated relationship between two variables. This is far from “proving” that some variable (X) causes some change in another variable (Y).</p>
<p>Okay, where on earth is all of this pessimism coming from? A lot of it actually comes from a simple phrase that you may have heard before, especially if you have taken an Intro to Statistics course. “Correlation does not imply causation”. This phrase frustrates me for many reasons, although, there is a lot of truth in it. For one, many people will use this statement without considering the fact that sometimes, correlation is indicative of causation. Rain and plant growth are correlated, and we also know that this correlation is driven by a causal effect since rain → plant growth. In other cases, the exact opposite occurs. Humans are all too eager to assume that correlation <em>implies</em> causation. Roosters crowing and the sunrise are certainly correlated, but the rooster crowing obviously does not imply that the rooster’s crow → sunrise.</p>
<p>The example with the rooster and the sunrise seems way too obvious. Common sense should tell us that the rooster’s crow obviously does not cause the sun to rise. Why get worked up over such a trivial thing? Let’s think about something a bit more complicated. Let’s say we observe that consumers of diet sodas (Diet Dr.&nbsp;Pepper, because Dr.&nbsp;Pepper is better than Coke) are more likely to experience health problems. That is, Diet Dr.&nbsp;Pepper consumption and health problems are correlated. We <em>could</em> assume that the relationship is causal. That is: Diet Dr.&nbsp;Pepper consumption → health issues. As one drinks more Diet Dr.&nbsp;Pepper, one’s risk of health issues increase. Should we interpret this causally? No! And here is where we get to the other big issue with relying on correlation.</p>
<p>There is likely a <strong>confounding</strong> effect (several, really) complicating the potential of a causal relationship between Diet Dr.&nbsp;Pepper consumption and health issues. I can think of one right off the bat. Individuals who already have pre-existing health issues may be more motivated to “clean up” their dietary habits and switch to a healthier “diet” alternative. In addition, individuals with pre-existing health issues are, intuitively, more likely to experience health issues. So, the relationship looks like this:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>dag <span class="ot">&lt;-</span> <span class="fu">dagify</span>(health <span class="sc">~</span> ddpc <span class="sc">+</span> p_health,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>              ddpc <span class="sc">~</span> p_health,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">exposure =</span> <span class="st">"ddpc"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">"health"</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">coords =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="at">health =</span> <span class="dv">5</span>, <span class="at">ddpc =</span> <span class="dv">1</span>, <span class="at">p_health =</span> <span class="dv">3</span>),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> <span class="fu">c</span>(<span class="at">health =</span> <span class="dv">1</span>, <span class="at">ddpc =</span> <span class="dv">1</span>, <span class="at">p_health =</span> <span class="dv">3</span>)),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">labels =</span> <span class="fu">c</span>(<span class="at">health =</span> <span class="st">"Health"</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ddpc =</span> <span class="st">"Diet Dr. Pepper Consumption"</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">p_health =</span> <span class="st">"Pre-Existing Health"</span>))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>tidy_dag <span class="ot">&lt;-</span> dag <span class="sc">%&gt;%</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">node_status</span>()</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tidy_dag, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span> </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag</span>() <span class="sc">+</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>() <span class="sc">+</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> status)) <span class="sc">+</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> label, <span class="at">fill =</span> status),</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>, <span class="at">fill =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Confounders (variables that are assumed to have a causal impact on both the treatment - in this case, Diet Dr.&nbsp;Pepper consumption - and outcome - in this case, health status) are inconvenient truths that make use unable to interpret correlations as causal effects. We cannot be sure that any change in the outcome (health) is due to the treatment (Diet Dr.&nbsp;Pepper consumption) or the confounder (pre-existing health). Given that we know pre-existing health is a confounder, can we say that Diet Dr.&nbsp;Pepper consumption causes deterioration in health conditions? Without careful thinking and the right tools, no, we cannot. At best, we can see if Diet Dr.&nbsp;Pepper consumption and health are still correlated after adjusting for pre-existing health. As you can imagine, the real world is much more complex than the presence of just one confounder and this issue quickly compounds. Regardless of how “math-y” the study seems that you’re citing to win the argument at the dinner table, we can never be sure that a hidden, unknown confounder <em>is not</em> hiding beneath the surface (for the most part… we’ll get to that in a second). We could identify ten confounders that complicate the causal relationship between Diet Dr.&nbsp;Pepper consumption and health status and <em>still</em> not be entirely sure whether an 11th confounder is going unnoticed. Given that scholars understand that there is no way to know if a unobserved confounder is present, most have opted to settle for correlations and abandon the pursuit of causal inference entirely. What a bummer. Isn’t science supposed to be much more powerful than this?</p>
</section>
<section id="the-promise-and-pitfalls-of-the-rct" class="level3">
<h3 class="anchored" data-anchor-id="the-promise-and-pitfalls-of-the-rct">The Promise and Pitfalls of the RCT</h3>
<p>There is an alternative, however. And this alternative is a big reason for why we probably <em>can</em> trust science when it comes to crucial information like whether a certain medication works. The randomized controlled trial (RCT) is oftentimes viewed as the “gold standard” of scientific research. Given what I explained earlier, you may be shocked to learn that RCTs, when executed correctly, can move beyond correlation and establish causality.</p>
<p>How? What about the constant threat of the infamous unobserved confounder? Let’s set the stage to understand how this works. Let’s pretend that you and I are researchers setting out to understand if a certain drug, Drug X (the treatment), causes an increase in muscle mass (the outcome). We can do two things. For one, we can ignore the FDA and release this drug to the public and track information on who buys the drug, individuals who do not buy the drug, and their subsequent muscle masses after taking/not taking the drug. We can then observe that users of Drug X had higher muscle growth than those who did not take Drug X. Causal effect, right? Nope. Let’s draw another DAG (a directed acyclic graph… you saw one earlier and we will go into much greater detail in following blog posts) and quickly point out some confounders</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dag2 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(muscle <span class="sc">~</span> drugx <span class="sc">+</span> age <span class="sc">+</span> s_train,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>              drugx <span class="sc">~</span> age <span class="sc">+</span> s_train,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>              s_train <span class="sc">~</span> age,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">exposure =</span> <span class="st">"drugx"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">"muscle"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">coords =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="at">muscle =</span> <span class="dv">5</span>, <span class="at">drugx =</span> <span class="dv">1</span>, <span class="at">age =</span> <span class="dv">3</span>, </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">s_train =</span> <span class="dv">3</span>),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> <span class="fu">c</span>(<span class="at">muscle =</span> <span class="dv">3</span>, <span class="at">drugx =</span> <span class="dv">3</span>, <span class="at">age =</span> <span class="dv">1</span>, </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">s_train =</span> <span class="dv">5</span>)),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">labels =</span> <span class="fu">c</span>(<span class="at">muscle =</span> <span class="st">"Muscle Mass"</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">drugx =</span> <span class="st">"Drug X"</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">age =</span> <span class="st">"Age"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">s_train =</span> <span class="st">"Strengh Training"</span>))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>tidy_dag2 <span class="ot">&lt;-</span> dag2 <span class="sc">%&gt;%</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">node_status</span>()</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tidy_dag2, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span> </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag</span>() <span class="sc">+</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>() <span class="sc">+</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> status)) <span class="sc">+</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> label, <span class="at">fill =</span> status),</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>, <span class="at">fill =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>If we let anyone choose whether they would like to take Drug X, we are introducing all sorts of problems. I noted two of these problems in the DAG, but you can probably think of more. First, individuals who are already committed to muscle mass through a strength training routine will likely have higher muscle mass <em>and</em> may be more willing to take a novel muscle-growth drug. Second, younger people are more likely to engage in a strength training routine and may be more willing to consume a novel drug due to a lack of prior medications and potential complications with mixing prior medication and Drug X. Further, youth provides the added benefit of natural muscle growth. With just two confounders outlined, we are back to Step 1, <strong>again</strong>.</p>
<p>And this is why we prefer the second option, the RCT. It turns out that if we don’t let people choose if they are receiving treatment, we magically (<em>poof</em>) eliminate confounding effects. We still need <em>voluntary</em> participants, however, so let’s say we recruit 1,200 individuals to participate in our study. Following this, we randomly assign who gets Drug X and who gets the placebo (these individuals serve as the control group who <em>do not</em> get treatment). It is important to not overlook what just happened in this sentence. If we <em>randomly</em> assign who gets access to the treatment, then no other variable can be correlated with treatment. Older and younger people will be equally represented in the treated and control groups because what determined their status as treated or control came down to the equivalent of a coin flip. For the same reason, strength trainers and couch potatoes will be equally represented in the treated and control groups. Theoretically, <em>any</em> confounder (known or unknown) will have equal representation in the treated and control groups. In the updated DAG below, here is what we’ve done with randomization:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dag3 <span class="ot">&lt;-</span> <span class="fu">dagify</span>(muscle <span class="sc">~</span> drugx <span class="sc">+</span> age <span class="sc">+</span> s_train,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>              drugx <span class="sc">~</span> chance,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>              s_train <span class="sc">~</span> age,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">exposure =</span> <span class="st">"drugx"</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">"muscle"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">coords =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="at">muscle =</span> <span class="dv">5</span>, <span class="at">drugx =</span> <span class="dv">1</span>, <span class="at">age =</span> <span class="dv">3</span>, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">s_train =</span> <span class="dv">3</span>, <span class="at">chance =</span> <span class="dv">1</span>),</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> <span class="fu">c</span>(<span class="at">muscle =</span> <span class="dv">3</span>, <span class="at">drugx =</span> <span class="dv">3</span>, <span class="at">age =</span> <span class="dv">1</span>, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">s_train =</span> <span class="dv">5</span>, <span class="at">chance =</span> <span class="dv">5</span>)),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">labels =</span> <span class="fu">c</span>(<span class="at">muscle =</span> <span class="st">"Muscle Mass"</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">drugx =</span> <span class="st">"Drug X"</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">age =</span> <span class="st">"Age"</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">s_train =</span> <span class="st">"Strengh Training"</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">chance =</span> <span class="st">"Random Chance"</span>))</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>tidy_dag3 <span class="ot">&lt;-</span> dag3 <span class="sc">%&gt;%</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">node_status</span>()</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tidy_dag3, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span> </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag</span>() <span class="sc">+</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>() <span class="sc">+</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> status)) <span class="sc">+</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> label, <span class="at">fill =</span> status),</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>, <span class="at">fill =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>By definition, nothing is correlated with chance since… it’s chance. Remember that confounders need to be causally linked to treatment <em>and</em> outcome. We got rid of the causal link to treatment part, so we have successfully eliminated all confounding effects. While impressive, the RCT has a very noticeable drawback. It is very difficult to implement. Not all research questions are those where it is feasible or ethical to conduct an RCT. Let’s take my personal research interest as an example, the study of conflict management. Many scholars and policymakers have argued that foreign aid, for example, is a positive force to assist countries recovering from war. Think about whether we could use an RCT here. On the practicality front, the answer is no. No government is going to allow me to randomly assign billion-dollar foreign aid packages to various countries. Now let’s consider the ethical problem. Even if governments would allow me to do so, it is hardly ethical to randomly assign potentially life-saving aid. At best, in these situations and many others, researchers merely <em>observe</em> who gets access to treatment (with observational data) rather than <em>assigning</em> who gets treatment (with experimental data).</p>
</section>
<section id="the-causal-revolution" class="level3">
<h3 class="anchored" data-anchor-id="the-causal-revolution">The Causal Revolution</h3>
<p>Barring an ability to assign treatment, it seems that we’re back to Step 1 again. Time to settle for correlation when all we have is observational data? Many scholars have, and continue to do so, at this point. Lucky for most researchers, a surprisingly under-the-radar movement and set of scientific contributions known as the “Causal Revolution” has been brewing over the past couple of decades and its insights and capacities are starting to become widely known in academia and data science.</p>
<p>I won’t get too much into the weeds in this blog post concerning the innovations of the Causal Revolution (there are many), but I would summarize the contributions of the Causal Revolution for causal inference with observational data into four topics. Those nifty DAGs I have shown throughout this blog are <em>extremely valuable</em> for visualizing and specifying confounding (and other) effects. As the research question grows in complexity, so does the DAG and it is very helpful to use DAGs to isolate a variety of causal effects. Second, the Causal Revolution has supplied researchers with an entire causal language that was previously unspoken. As these blog posts continue, you will see all sorts of examples of this new lexicon including: confounders, mediators, colliders, direct effects, indirect effects, various treatment effects, etc. Third, a variety of methods have been developed and refined to estimate causal effects (of which a large portion of blog posts in this series will be concerned with). Lastly, scholars have developed and implemented a crucial type of analysis called “sensitivity analysis” that evaluates the impact of those pesky potentially unobserved confounders (again, we will talk about this in later blog posts).</p>
<p>At the very beginning of this series, it is hard to emphasize the monumental importance of these innovations. I think a helpful way of understanding the impact of the Causal Revolution is to compare the state of scientific output now compared to what it was twenty years ago. Two decades ago, language of “causality”, “causal effects”, and even the word “cause” were shunned in many domains where RCTs were not an option. Even when I started graduate school in 2018, the same norm persisted in my department. No language or methods existed to support the leap from correlation to causation. Scholars relied on correlations as a way of assessing the impact of their findings, going right up to the line of interpreting their correlative findings as causal, despite no methods existing to support that leap. Twenty years later, an abundance of methods and innovations support scholars who are now answering questions that researchers, policymakers, and the average individual are interested in. For many areas of study, science is finally capable of answering the questions we have been interested in all along.</p>
</section>
<section id="potential-outcomes" class="level3">
<h3 class="anchored" data-anchor-id="potential-outcomes">Potential Outcomes</h3>
<p>Okay, really quick (but very important) side note here. Have you noticed that I haven’t really discussed what causality <em>is</em> or how to evaluate it? We all have a general understanding of causality (if I throw a ball, that movement will <em>cause</em> the ball to move in the direction I threw it), but if we’re going to be all science-y and specific about it, we should consider <em>what we’re actually talking about</em> when we causation.</p>
<p>Judea Pearl, an instrumental figure (probably <em>the</em> instrumental figure) in the Causal Revolution blatantly avoided precisely defining causality in his fairly-laymen-friendly book, “The Book of Why”. If he avoided providing a precise definition, then who am I to fill in that gap? Rather than giving you a specific definition, I think a general framework is more fruitful for comprehending what causality implies.</p>
<p>Whether we realize it or not, humans tend to think about causality in terms of counterfactuals (things that didn’t happen, but could have). Think about it. If you get pulled over by a cop for speeding, you understand that, in an alternative world where you were not speeding on that specific highway on that specific day, you probably would not have been pulled over. So, you understand that speeding has a causal effect on the risk of being pulled over by the police. You understand this because you contrast the real world with a counterfactual world where everything else was the same, but you were not speeding. It’s actually that simple. The causal effect of speeding on being pulled over is merely the difference between the real world in which you sped contrasted with the alternative world in which you were not speeding. Any time I mention a causal effect, it is very helpful to think about what that means in this potential outcomes framework.</p>
<p>You might be wondering, “that concept makes sense theoretically, but it is practically impossible.” This is correct. We cannot simulate the <em>exact same day</em> for you where the only difference is that you do not speed and compare that to the real world where you have to deal with a speeding ticket. This realization is known as “the fundamental problem of causal inference”. If we had time machines, this wouldn’t be a problem at all. We just go back in time and tell you not to speed on the day where you were pulled over in the original timeline. But we don’t have time machines. So why care about this framework? Is causal inference even possible? Yes, it is. And we will touch up on this issue and how researchers overcome it in later blog posts discussing treatment effects.</p>
<p>In the following blog post, we will take a deeper look into directed acyclic graphs (DAGs), beginning with why they have such a complicated name despite being an incredibly intuitive tool. We will look at their effectiveness in identifying a variety of effects (and discuss why identifying these respective effects is important), and review the concept of adjustment. Before we collect any data or implement a particular method, it is important to understand that causal inference starts with setting aside time to carefully consider causal relationships within a research question. This is why understanding DAGs and visualizing theoretical causal relationships is so important. If we fail to get this part right, then we cannot assign much confidence to the following steps.</p>
</section>
<section id="recommended-materials" class="level3">
<h3 class="anchored" data-anchor-id="recommended-materials">Recommended Materials</h3>
<p>For those of you reading this who have a legitimate interest in causal inference and want to know more, I could not recommend the resources below more:</p>
<ul>
<li><p><a href="https://evalsp23.classes.andrewheiss.com/">Program Evaluation Course Provided by Dr.&nbsp;Andrew Heiss</a>: I am putting this at the top of the list for a reason. Dr.&nbsp;Heiss’s course is comprehensive, easy to digest for those who do not come from a strong technical background, and aesthetically pleasing. While it may take some time, I highly suggest taking this entire course. Dr.&nbsp;Heiss also has a lot of valuable information on his <a href="https://www.andrewheiss.com/blog/">blog</a> and <a href="https://github.com/andrewheiss">GitHUb</a>.</p></li>
<li><p><a href="https://theeffectbook.net/index.html">The Effect</a>: A fantastic and comprehensive book that covers so much and is so beginner-friendly. As an added plus, this book also provides code for the implementation of methods via R, Python, and Stata. (Plus its free).</p></li>
<li><p><a href="https://mixtape.scunning.com/">Causal Inference: The Mixtape</a>: Another great book that provides very heplful beginner information relating to causal inference. (Also free).</p></li>
<li><p><a href="https://journals.sagepub.com/doi/10.1177/2515245917745629">Rohrer (2018)</a>: Reading this article was my first time being exposed to DAGs and the issue of confounding. It is incredibly concise and easy to understand and it is an easy starting point.</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>