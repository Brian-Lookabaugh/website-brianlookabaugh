<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.120">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Brian Lookabaugh">
<meta name="dcterms.date" content="2023-02-16">
<meta name="description" content="An introduction to DAGs, adjustment, and creating DAGs in R.">

<title>Brian Lookabaugh - Causal Inference for Casuals, Part II</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../images/sticker.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../images/sticker.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Brian Lookabaugh</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../resume/index.html">Resume</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../projects/index.html">Projects</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../blog/index.html">Blog</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/brian-lookabaugh-372ab31a1/"><i class="bi bi-linkedin" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Brian-Lookabaugh"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:brianlookabaughjr@gmail.com"><i class="bi bi-envelope" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#what-are-dags-used-for" id="toc-what-are-dags-used-for" class="nav-link active" data-scroll-target="#what-are-dags-used-for">What Are DAGs Used For?</a></li>
  <li><a href="#backdoor-adjustment" id="toc-backdoor-adjustment" class="nav-link" data-scroll-target="#backdoor-adjustment">Backdoor Adjustment</a></li>
  <li><a href="#the-big-five" id="toc-the-big-five" class="nav-link" data-scroll-target="#the-big-five">The Big Five</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Causal Inference for Casuals, Part II</h1>
<p class="subtitle lead">Making Causal Assumptions Clear With DAGs</p>
  <div class="quarto-categories">
    <div class="quarto-category">causal inference</div>
    <div class="quarto-category">DAGs</div>
  </div>
  </div>

<div>
  <div class="description">
    An introduction to DAGs, adjustment, and creating DAGs in R.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Brian Lookabaugh </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 16, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="what-are-dags-used-for" class="level3">
<h3 class="anchored" data-anchor-id="what-are-dags-used-for">What Are DAGs Used For?</h3>
<p>Let’s start off with clarifying what “DAG” even means. In the prior blog post, I noted that it stood for “directed acyclic graph”, but I didn’t go into detail over what that mouthful means. It’s actually surprisingly simple. First of all, its a graph… easy enough. It is a <em>directed</em> graph because of the directions the arrows provide that imply a causal relationship. Lastly, it is <em>acyclic</em> because you can never end up at a node (the circles) once you have progressed beyond it. Simply put, there is no cycle in the directed graph. If A → B → C, then C cannot → A. If it does, the graph is cyclical and I’m sure this breaks all of the complicated math underlying DAGs.</p>
<p>Definition aside, what are DAGs used for? We talked about this a bit in the previous blog, but we will briefly review this again. First, recall from the previous post that <em>confounding effects</em> seriously complicate or eliminate our ability to infer causation (aka “to make causal inferences” or “to determine if a causal relationship exists”). But how do we know what is and what is not a confounding effect? You guessed it… DAGs! Real-world research questions get very complex very quickly, with dozens of variables and causal relationships to consider. It’s best we don’t burden our brain with figuring out which variables are confounders and which are not when DAGs can figure this out for us. Further, DAGs are great for clearly specifying causal assumptions that model and causal estimates are generated from (remember that DAGs don’t magically <em>prove</em> causation… they make clear causal assumptions). From a scientific perspective, this is great since it breaks down the “black box” of our own assumptions and allows our causal assumptions to be made clear, transparent, and available for critique and refinement. On a personal level, that may not feel so great. But for the purposes of quality scientific research, it is desperately needed.</p>
<p>Again, DAGs are great for identifying confounders, but there are many more effects than confounding effects and it is important that we identify these effects as well. Why is it so important? For one, speaking from the background that I come from, a culture of “controlling for everything” exists and is still fairly prominent in many literatures. Scholars will frequently make jokes about reviewers at scientific journals who will reject a paper because it isn’t controlling for some niche, seemingly insignificant variable. However, many scholars have pointed out that this culture of controlling for everything is harmful for the generation of accurate causal estimates <span class="citation" data-cites="rohrerThinkingClearlyCorrelations2018 cinelliCrashCourseGood2022">(<a href="#ref-rohrerThinkingClearlyCorrelations2018" role="doc-biblioref">Rohrer 2018</a>; <a href="#ref-cinelliCrashCourseGood2022" role="doc-biblioref">Cinelli, Forney, and Pearl 2022</a>)</span>. So what should be controlled (or “adjusted”) for and what shouldn’t?</p>
</section>
<section id="backdoor-adjustment" class="level3">
<h3 class="anchored" data-anchor-id="backdoor-adjustment">Backdoor Adjustment</h3>
<p>Before we can answer those questions, we need to be familiar with the concept of backdoor adjustment. By this point, you have already been exposed to backdoor adjustment from the last blog post. But we will review it again in detail here as well. A path is a “backdoor path” if a non-causal association can be transmitted between treatment and outcome indirectly. For example, A ← B → C introduces a backdoor path between A and C via B. A and C are not causally linked (there is no arrow linking A to C directly), but we can still witness a spurious (false) association between the two due to the influence of the pesky confounder, B. Backdoor adjustment is simply adjusting for these effects. If we adjust for B, then we eliminate its arrows that point into A and C. (I do not go into the math of how this works in these blog posts. If you are interested in an introduction to do-calculus, I suggest checking out “The Book of Why” by Judea Pearl). As a result, we eliminated the confounding bias of B. There’s actually another type of adjustment called “front-door adjustment” (but we will wait to discuss this in a future blog post discussing instrumental variables). What’s important now is to know that DAGs can clearly identify which variables need to be adjusted for via backdoor adjustment. Equally important, DAGs also tell us which variables <em>do not</em> need to be adjusted for. We’ll get into this in the following section.</p>
</section>
<section id="the-big-five" class="level3">
<h3 class="anchored" data-anchor-id="the-big-five">The Big Five</h3>
<p>DAGs are one of those topics that are best discussed with visuals (we are talking about graphs, after all). I am going to create a DAG that models the relationship between fertilizer and crop yield and then we’ll talk about “the Big Five” (this will make a lot more sense after the DAG is constructed). I’ll annotate the code so that you can follow along and create your own DAGs in R if you would like. If you’d like to follow along and don’t want to program in R, check out <a href="http://www.dagitty.net/dags.html#">dagitty website</a> which is a very intuitive tool to create your own DAGs online.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># General Data Manipulation</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty) <span class="co"># Creating DAGs</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag) <span class="co"># Plotting DAGs</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>dag <span class="ot">&lt;-</span> <span class="fu">dagify</span>(crops <span class="sc">~</span> rain <span class="sc">+</span> insects <span class="sc">+</span> soil_qual, <span class="co"># Specifying Causal Relationships</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>              soil_qual <span class="sc">~</span> fert,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>              fert <span class="sc">~</span> need <span class="sc">+</span> rain,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>              labor <span class="sc">~</span> fert <span class="sc">+</span> crops,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">exposure =</span> <span class="st">"fert"</span>, <span class="co"># Defining Exposure/Treatment </span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">"crops"</span>, <span class="co"># Defining Outcome</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">coords =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="at">crops =</span> <span class="dv">5</span>, <span class="at">rain =</span> <span class="dv">3</span>, <span class="at">insects =</span> <span class="dv">5</span>, <span class="at">soil_qual =</span> <span class="dv">3</span>, <span class="co"># Customizing Placement of Nodes</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">fert =</span> <span class="dv">1</span>, <span class="at">need =</span> <span class="dv">1</span>, <span class="at">labor =</span> <span class="dv">3</span>),</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> <span class="fu">c</span>(<span class="at">crops =</span> <span class="dv">3</span>, <span class="at">rain =</span> <span class="dv">5</span>, <span class="at">insects =</span> <span class="dv">5</span>, <span class="at">soil_qual =</span> <span class="dv">3</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">fert =</span> <span class="dv">3</span>, <span class="at">need =</span> <span class="dv">1</span>, <span class="at">labor =</span> <span class="dv">1</span>)),</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">labels =</span> <span class="fu">c</span>(<span class="at">crops =</span> <span class="st">"Crops"</span>, <span class="at">rain =</span> <span class="st">"Rain"</span>, <span class="at">insects =</span> <span class="st">"Insects"</span>, <span class="co"># Customizing Names for Nodes</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">soil_qual =</span> <span class="st">"Soil Quality"</span>, <span class="at">fert =</span> <span class="st">"Fertilizer"</span>,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">need =</span> <span class="st">"Need"</span>, <span class="at">labor =</span> <span class="st">"Labor"</span>))</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>tidy_dag <span class="ot">&lt;-</span> dag <span class="sc">%&gt;%</span> <span class="co"># Converting to a Tidy Object for Better Plotting</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">node_status</span>()</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tidy_dag, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span> <span class="co"># Plotting and Customizing the DAG</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag</span>() <span class="sc">+</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>() <span class="sc">+</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> status)) <span class="sc">+</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> label, <span class="at">fill =</span> status),</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>, <span class="at">fill =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>First of all, I am <strong>not an expert in agriculture</strong> so I’m sure this model is not correct. Lucky for us, it doesn’t need to be. I just need to use this as an example. First, this model is much more complex than the DAGs in the previous blog. In reality, if I was truly interested in estimating the causal impact of fertilizer on crop yield, the DAG would most likely look even more complicated than this one! Still, this DAG is sufficient to discuss what I call “the Big Five” (this isn’t terminology used by anyone else… I’m just using it because the five effects we’ll be discussing appear to be among the most common that researchers identify when generating their own DAGs). Let’s go through each one-by-one:</p>
<ul>
<li><p><strong>Rain</strong>: “Rain” is our classic confounder that you should be familiar with by this point by glancing at the DAG. (Hint: We need to adjust for this fellow). Many fertilizers will not be functional without rain, and many farmers may not be willing to use fertilizer if they suspect rain is not coming anytime soon. Further, we all understand that rain - whether too little, just the right amount, or too much - has a clear causal impact on crop yields.</p></li>
<li><p><strong>Soil Quality</strong>: From my understanding, different fertilizers do different things. Let’s say the fertilizer being examined here improves soil quality which, in turn, improves crop yields. In this respect, soil quality is a <strong>mediator</strong>. It is a bad idea to adjust for a mediator since the mediator is part of the causal process being examined. How silly is it to say, “I am going to estimate the causal impact of fertilizer on crop yield and control for… the causal effect of fertilizer on crop yield…”. If we adjust for soil quality, we are blocking the causal effect of fertilizer on crop yield in our own model. That is basically the opposite of what we are trying to accomplish.</p></li>
<li><p><strong>Labor</strong>: Using increased fertilizer and having an increased amount of crop yield is going to cause a need for more labor. When the treatment and outcome both causally lead to another variable, this is called a <strong>collider</strong>. Adjusting for a collider can introduce a spurious relationship between treatment and outcome. A collider on its own does not open a backdoor path, but if we were to control for labor, we actually open the backdoor path! Many researchers may be familiar with a variant of controlling for colliders known as “selection bias”. Colliders should not be controlled for and “Labor” is a bad control in the case of this model. Where we see colliders, we should leave them alone.</p></li>
<li><p><strong>Insects</strong>: Harmful insects are obviously going to impact crop yields. In this DAG, we are assuming that insects are neither caused by, nor cause, any other node specified in the DAG. Because “Insects” <em>only effects the outcome</em>, this variable is a <strong>neutral control</strong>. This means that the “Insects” variable neither opens (like adjusting for a collider does) nor closes (like adjusting for a confounder does) any backdoors. However, this particular type of neutral control, when included in a model, has the potential to improve the precision of a causal estimate (the numeric value stating how much X impacts Y).</p></li>
<li><p><strong>Need</strong>: A farmer may be more likely to pursue the use of fertilizer if there is sufficient economic motive to do so. Perhaps, for this season, the family farm can only stay in operation if a good harvest is reaped in the fall. Because we are assuming that need only impacts the treatment, “need” is also a neutral control. However, unlike the former neutral control, adjusting for neutral controls that lead to treatment may lead to less precise causal estimates. As <span class="citation" data-cites="cinelliCrashCourseGood2022">Cinelli, Forney, and Pearl (<a href="#ref-cinelliCrashCourseGood2022" role="doc-biblioref">2022</a>)</span> note, a good rule-of-thumb is that neutral controls like “Insect” are generally beneficial to include while neutral controls like “Need” are generally harmful to include. In fact, I highly recommend using <span class="citation" data-cites="cinelliCrashCourseGood2022">Cinelli, Forney, and Pearl (<a href="#ref-cinelliCrashCourseGood2022" role="doc-biblioref">2022</a>)</span> as a reference. We only discuss five types of possible controls here, but their article covers 18 different types of controls and it is a great resource to examine whether a certain variable actually needs to be controlled for.</p></li>
</ul>
<p>Which of these should we adjust for to understand whether fertilizer → crop yield? In this DAG (which may be inaccurate based on my poor prior agricultural information), the only variable in which it is necessary to control for is “Rain” since rain opens a back-door path between fertilizer and crop yield. If we ran a model with only fertilizer and crop yields specified, we may find that, as fertilizer increases, so do crop yields. However, we should be skeptical because we know that rain causes some change in both fertilizer usage and crop yield. If we fail to account for rain, the causal relationship between fertilizer and crop yield could be spurious (non-existent, even though it looks like it may exist) because of the back-door path: Fertilizer ← Rain → Crop Yield. Perhaps rain explains most (maybe all) of the variation in crop yield and fertilizer is just there for the ride. While not necessary, it is good practice to likewise adjust for “Insects” as well. Adjusting for insects won’t close any back-door paths like Rain did. However, it will make our causal estimate more precise.</p>
<p>Let’s say we run the following model: Crop Yield = Fertilizer + Rain. Let’s pretend that this model tells us that, for every 1% increase in fertilizer, crop-yield increases by 0.7%. Keep in mind, we have adjusted for rain, so we’re not super concerned about whether this relationship is spurious anymore. We’re pretty sure this effect is real and is not tainted somehow by an unobserved confounder. However, maybe that 0.7% estimate isn’t as precise as it could be? With causal inference, we want to know 1) is this causal relationship real or fake and 2) is the causal estimate precise? As discussed earlier, “Insects” can and should be included to improve the causal estimate. So we run the new model: Crop Yield = Fertilizer + Rain + Insects. Now, this model tells us that every 1% increase in fertilizer is associated with 0.78% increase in crop yield. A seemingly minor change, but it gets us closer to the true causal effect of fertilizer on crop yield. Again, this model is a product of a simplified understanding of the causal relationship linking fertilizer → crop yield. If you actually want to pursue this, you need to put a lot more time and research into agricultural research than I have. However, if we assume that the DAG I made is accurate (humor me, this is for educational purposes), then the model, Crop Yield = Fertilizer + Rain + Insects, is the appropriate model for causal inference.</p>
<p>However, as I’ve mentioned before, DAGs can get much more complicated than this. It is going to be tedious to try and isolate confounders on your own. Like anything else, let the computer do it for you. For example, we can run the following line of code to generate text output of the minimal adjustment set to close back-doors:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustmentSets</span>(dag)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{ rain }</code></pre>
</div>
</div>
<p>By now, the introductory reader should know that associations/correlations are not sufficient to determine causation. Confounders are oftentimes the prime culprit for why associations fall short of causation. Confounders (what you should adjust for) and other types of variable (mediators, colliders, etc. - what you should not adjust for) can be identified with DAGs. When we adjust for the right things, we can move from evaluating correlations between variables to establishing causal relationships between variables. This is solid information that represents the bedrock of causal inference. However, so far, we’ve talked about “causal effects” very loosely and failed to appreciate the complexity of such a topic. What does a causal effect even mean and what is it supposed to represent? We cannot estimate causal effects for each individual unit (we cannot determine whether a single ear of corn was produced because of fertilizer) so how do we obtain causal effects in the first place? These questions will be discussed in the following blog post.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-cinelliCrashCourseGood2022" class="csl-entry" role="doc-biblioentry">
Cinelli, Carlos, Andrew Forney, and Judea Pearl. 2022. <span>“A <span>Crash Course</span> in <span>Good</span> and <span>Bad Controls</span>.”</span> <em>SSRN Journal</em>, 1–34. <a href="https://doi.org/10.2139/ssrn.3689437">https://doi.org/10.2139/ssrn.3689437</a>.
</div>
<div id="ref-rohrerThinkingClearlyCorrelations2018" class="csl-entry" role="doc-biblioentry">
Rohrer, Julia M. 2018. <span>“Thinking <span>Clearly About Correlations</span> and <span>Causation</span>: <span>Graphical Causal Models</span> for <span>Observational Data</span>.”</span> <em>Advances in Methods and Practices in Psychological Science</em> 1 (1): 27–42.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>