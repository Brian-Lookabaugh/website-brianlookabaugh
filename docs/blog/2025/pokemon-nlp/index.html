<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-09-15">
<meta name="description" content="I’ve been looking for a way to work with Pokemon data for a while now, so I shoehorned topic modeling and natural language processing in there to finally justify it…">

<title>Predicting Pokemon Types with Pokedex Text Entries – Brian Lookabaugh</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../images/stickerv2.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-S362C5PLRJ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-S362C5PLRJ', { 'anonymize_ip': true});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../images/stickerv2.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Brian Lookabaugh</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../resume/index.html"> 
<span class="menu-text">Resume</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../research/index.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/brian-lookabaugh-phd-372ab31a1/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Brian-Lookabaugh"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:brianlookabaughjr@gmail.com"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#introducing-the-pokemon-data-set" id="toc-introducing-the-pokemon-data-set" class="nav-link active" data-scroll-target="#introducing-the-pokemon-data-set">Introducing the Pokemon Data Set</a></li>
  <li><a href="#strategy" id="toc-strategy" class="nav-link" data-scroll-target="#strategy">Strategy</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Predicting Pokemon Types with Pokedex Text Entries</h1>
  <div class="quarto-categories">
    <div class="quarto-category">nlp</div>
    <div class="quarto-category">llm</div>
    <div class="quarto-category">topic modeling</div>
    <div class="quarto-category">machine learning</div>
    <div class="quarto-category">pokemon</div>
  </div>
  </div>

<div>
  <div class="description">
    I’ve been looking for a way to work with Pokemon data for a while now, so I shoehorned topic modeling and natural language processing in there to finally justify it…
  </div>
</div>


<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 15, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dplyr"</span>, <span class="co"># Data Manipulation</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"readxl"</span>, <span class="co"># Reading Excel Files</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tidyr"</span>, <span class="co"># Pivoting</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ggplot2"</span>, <span class="co"># Data Visualization</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"stringr"</span>, <span class="co"># Working with Strings</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"purrr"</span>, <span class="co"># Mapping</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"forcats"</span>, <span class="co"># Factors</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ggdist"</span>, <span class="co"># Cool Distribution Plots</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tibble"</span>, <span class="co"># rownames_to_columns</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"stringr"</span>, <span class="co"># Working with Texts</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tidytext"</span>, <span class="co"># NLP</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"quanteda"</span>, <span class="co"># NLP</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tm"</span>, <span class="co"># NLP</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"SnowballC"</span>, <span class="co"># NLP</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"caret"</span>, <span class="co"># Machine Learning</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"stopwords"</span>, <span class="co"># Stop Words</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"seededlda"</span>, <span class="co"># Seeded LDA</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"tinytable"</span>, <span class="co"># Tables</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">install =</span> <span class="cn">FALSE</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a Custom Theme</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>blog_theme <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>  </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray80"</span>, <span class="at">size =</span> <span class="fl">0.3</span>),</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">15</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">15</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">15</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">10</span>), </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">10</span>), </span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey80"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"grey25"</span>),</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Establish a Custom Color Scheme</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0a697d"</span>,</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0091af"</span>,</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#ddb067"</span>,</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#c43d56"</span>,</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#ab2a42"</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Establish a Pokemon Color Scheme</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>type_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">normal =</span> <span class="st">"#A8A77A"</span>,</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">fire =</span> <span class="st">"#EE8130"</span>,</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">water =</span> <span class="st">"#6390F0"</span>,</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">electric =</span> <span class="st">"#F7D02C"</span>,</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">grass =</span> <span class="st">"#7AC74C"</span>,</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">ice =</span> <span class="st">"#96D9D6"</span>,</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">fighting =</span> <span class="st">"#C22E28"</span>,</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">poison =</span> <span class="st">"#A33EA1"</span>,</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">ground =</span> <span class="st">"#E2BF65"</span>,</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  <span class="at">flying =</span> <span class="st">"#A98FF3"</span>,</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  <span class="at">psychic =</span> <span class="st">"#F95587"</span>,</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">bug =</span> <span class="st">"#A6B91A"</span>,</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">rock =</span> <span class="st">"#B6A136"</span>,</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  <span class="at">ghost =</span> <span class="st">"#735797"</span>,</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>  <span class="at">dragon =</span> <span class="st">"#6F35FC"</span>,</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">dark =</span> <span class="st">"#705746"</span>,</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  <span class="at">steel =</span> <span class="st">"#B7B7CE"</span>,</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  <span class="at">fairy =</span> <span class="st">"#D685AD"</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Establish a Custom Naming Scheme</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>type_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">grass =</span> <span class="st">"Grass"</span>,</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">fire =</span> <span class="st">"Fire"</span>,</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">water =</span> <span class="st">"Water"</span>,</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">normal =</span> <span class="st">"Normal"</span>,</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">electric =</span> <span class="st">"Electric"</span>,</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">ice =</span> <span class="st">"Ice"</span>,</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">fighting =</span> <span class="st">"Fighting"</span>,</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">poison =</span> <span class="st">"Poison"</span>,</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">ground =</span> <span class="st">"Ground"</span>,</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">flying =</span> <span class="st">"Flying️"</span>,</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">psychic =</span> <span class="st">"Psychic"</span>,</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">bug =</span> <span class="st">"Bug"</span>,</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">rock =</span> <span class="st">"Rock"</span>,</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">ghost =</span> <span class="st">"Ghost"</span>,</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>  <span class="at">dragon =</span> <span class="st">"Dragon"</span>,</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>  <span class="at">dark =</span> <span class="st">"Dark"</span>,</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>  <span class="at">steel =</span> <span class="st">"Steel️"</span>,</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">fairy =</span> <span class="st">"Fairy"</span></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Even if you’re not familiar with a lot of data science terminology, you’ve potentially heard of the term “natural language processing” (NLP). Most likely, you’ve probably heard of it within the context of AI/large language models (LLMs). Regardless, natural language processing really just refers to any statistical/machine learning/AI approach that seeks to uncover information and insights from human language. This can range from something as simple as a count of specific words in a document all the way to ChatGPT.</p>
<p>Somewhere in the middle of that wide distribution is the field of topic modeling. Topic modeling is a sub-field of NLP that is applicable when a researcher has a large body of text (books, chapters, open-text survey responses, Word documents, emails, etc.) and wants to extract some of the themes/topics referenced in this body (a corpus) without manually reading every item in that corpus. There’s a lot of different ways that you can do topic modeling, but typically when you mention it, the methodology of automatically extracting topics out of a corpus is driven by an algorithm developed for this very purpose (often, you will hear of something called <a href="https://www.tidytextmining.com/topicmodeling#latent-dirichlet-allocation">“Latent Dirichlet Allocation”</a>).</p>
<p>In my line of work, I deal <em>a lot</em> with survey data. All of us have taken surveys, so you’re probably familiar with the concept of an <em>open-text</em> survey question. For example, you could easily imagine something like “please describe anything else related to X that was not covered in this survey” and you’re given a text box to fill in (if you so choose, a lot of people just leave it blank or fill in “NA” if they don’t have anything to share/can’t be bothered to write anything down).</p>
<p>These open-text survey questions are great in one sense because they don’t force the respondents to match their answer to some set of discrete options the survey programmer designed. However, the difficult part is that it’s really hard to process and make sense of <em>a lot</em> of open-text survey responses. With discrete responses, it’s really easy since the response is converted to a numeric output. But how do you make sense of hundreds or thousands of open-text responses? You <em>could</em> manually code all of these responses but… have fun with that and let me know when you and your double checker coder are done at Christmas. Naturally, this scenario is a natural use-case for topic modeling. Consequently, I’ve used topic modeling algorithms a lot in my work for this very purpose.</p>
<p>But… is topic modeling the best way to handle problems like this anymore? Perhaps some of you have already thought, “why not feed the open-text response into ChatGPT and let it tell you what it’s about rather than having to learn these complex and, oftentimes, finicky topic modeling algorithms?” Well, one reason you might not do this is for privacy concerns. People are probably responding to these open-text items with an expectation that it won’t be fed into an LLM and, depending on who you are working for, you might have client restrictions that prevent you from feeding data into an LLM anyways. Another issue would be reproducibility. With a topic modeling algorithm, you can design the algorithm in such a way that the results are consistent and reproducible every time you run the same line of code. I’m not so sure you’re going to get the same properties out of querying an LLM (to be fair, you probably wouldn’t get the same results every time using human coders either).</p>
<p>Still <a href="https://journals.sagepub.com/doi/10.1177/20531680241231468">Mellon et al.&nbsp;(2024)</a> published an interesting study that compared the predictive accuracy of open-text survey topics when using human coders, LLMs, and topic models. A key takeaway is that <em>some</em> LLMs perform <em>almost</em> as well as human coders and often outperform topic modeling algorithms. I’m <em>really</em> interested in this because I’ve often seen firsthand the struggles that topic modeling algorithms can have. However, I have not been able to test out the LLM approach in my professional work for contract-related reasons. So, I decided to learn about this in a personal project… But what data set should I use?</p>
<p>Well I thought about this and considered just going to a popular social science survey and giving that a try… but that is too close to what I do for work and so I wanted to do something fun instead. Which is pretty much why I am using a Pokemon data set that sort of mimics what you’ll run into with an open-text survey response. In this blog, I’m going to be testing out a bunch of different ways to see if I can automatically classify a Pokemon’s type based on its Pokedex entry. Pokedex entries are often fairly sparse, with only 1-2 sentences for each Pokemon. That doesn’t sound like a lot (and it’s not) but it resembles the reality of many open-text responses where survey respondents often answer in incomplete sentences or, if you’re lucky, a handful of sentences. That’s just a natural challenge with analyzing open-text survey data, so I wanted to re-create that with a more laid back substitute.</p>
<section id="introducing-the-pokemon-data-set" class="level1">
<h1>Introducing the Pokemon Data Set</h1>
<p>You can find a lot of different Pokemon data sets online, but I needed to find one that had Pokedex entries. Ideally, I would have liked to have found a data set that contained <em>all</em> Pokedex entries (for those unfamiliar, each generation of Pokemon games creates a new Pokedex entry for the Pokemon from previous generations). But, I could not find anything like that. Plus, it sort of creates bias in the analysis since older Pokemon will have more entries, which basically translates to more data, so no matter what we use, we’d always see bias that predicts older Pokemon’s types better than the types of newer Pokemon. So, I used <a href="https://www.kaggle.com/datasets/rzgiza/pokdex-for-all-1025-pokemon-w-text-description/data">this data set</a> from Kaggle which contains Pokedex entries for all 1,025 Pokemon.</p>
<p>In the code chunk below, I am doing a couple of things to manipulate this data to be what I need it to be. For example, because some Pokemon have more than one type, I need to create another column that captures what type(s) Pokemon have. I do this by creating a dummy for each type (this will matter for making predictions later). Lastly, some Pokedex entries have the Pokemon’s name in the entry… which feels a little like cheating. Fortunately, when this happens, the Pokemon’s name is in full caps, so I use some regex to omit any string of text in a Pokemon’s Pokedex entry if it contains the Pokemon’s name.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pokedex <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/pokedex.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>pokedex <span class="ot">&lt;-</span> pokedex <span class="sc">|&gt;</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create Type Binary Columns</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">type_grass =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(type, <span class="st">"grass"</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">type_fire =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(type, <span class="st">"fire"</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">type_water =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(type, <span class="st">"water"</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">type_normal =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(type, <span class="st">"normal"</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">type_electric =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(type, <span class="st">"electric"</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">type_ice =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(type, <span class="st">"ice"</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">type_fighting =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(type, <span class="st">"fighting"</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">type_poison =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(type, <span class="st">"poison"</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">type_ground =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(type, <span class="st">"ground"</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">type_flying =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(type, <span class="st">"flying"</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">type_psychic =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(type, <span class="st">"psychic"</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">type_bug =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(type, <span class="st">"bug"</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">type_rock =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(type, <span class="st">"rock"</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">type_ghost =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(type, <span class="st">"ghost"</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">type_dragon =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(type, <span class="st">"dragon"</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">type_dark =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(type, <span class="st">"dark"</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">type_steel =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(type, <span class="st">"steel"</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">type_fairy =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(type, <span class="st">"fairy"</span>), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Clean "info" Column to Purge Identifying Information (Like the Pokemon's Name Which Is in All Caps In This Data Set)</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">info =</span> <span class="fu">str_remove_all</span>(info, <span class="st">"</span><span class="sc">\\</span><span class="st">b[A-Z]{2,}</span><span class="sc">\\</span><span class="st">b"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And just to make sure everything’s right, I’m going to take a look at defense statistics for each type. And… it looks like everything checks out with the distribution of defense statistics being higher in the steel, rock, ground, and dragon types. (Ghost type at #5 though?? Interesting).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Data Frame of Level 1, 2, and 3 Evolution</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>pokedex <span class="ot">&lt;-</span> pokedex <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(evo_set) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">level1 =</span> <span class="fu">as.integer</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">level2 =</span> <span class="fu">as.integer</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">2</span>),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">level3 =</span> <span class="fu">as.integer</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">3</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Long-Form Data Set for Typing</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>pokedex_long <span class="ot">&lt;-</span> pokedex <span class="sc">|&gt;</span> </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"type_"</span>),</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"type_name"</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"has_type"</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This Omits Copies Where a Given Pokemon Does Not Belong to a Given Type</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For Dual-Typing, Two Copies Are Made for the Pokemon</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(has_type <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type_name =</span> <span class="fu">str_remove</span>(type_name, <span class="st">"type_"</span>))</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution Plot by Defense</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pokedex_long, <span class="fu">aes</span>(</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> defense,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">fct_reorder</span>(type_name, defense, <span class="at">.fun =</span> mean),</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> type_name</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> <span class="fl">0.7</span>,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_interval =</span> <span class="cn">NULL</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> type_names) <span class="sc">+</span>  </span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> type_colors) <span class="sc">+</span> </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">blog_theme</span>() <span class="sc">+</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Defense"</span>,</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">""</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Distribution of Defense Stats Across Typing</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="strategy" class="level1">
<h1>Strategy</h1>
<p>Prior to getting into classification strategies, we need to clean up the text data. Below, I am just creating a basic text data cleaning function that does some of the basics like standardizing punctuation, setting all text to lower-case, removing stop words, etc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store Stop Words for Filtering</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>stop_words_data <span class="ot">&lt;-</span> stop_words<span class="sc">$</span>word</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Function to Clean Text</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>clean_text <span class="ot">&lt;-</span> <span class="cf">function</span>(text) {</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  text <span class="sc">|&gt;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set to Lowercase</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_to_lower</span>() <span class="sc">|&gt;</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove Possessive "'s"</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">"'s</span><span class="sc">\\</span><span class="st">b"</span>, <span class="st">""</span>) <span class="sc">|&gt;</span>   </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove Plural Possessives</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">bs'</span><span class="sc">\\</span><span class="st">b"</span>, <span class="st">""</span>) <span class="sc">|&gt;</span>   </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove Punctuation</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_replace_all</span>(<span class="st">"[^a-z</span><span class="sc">\\</span><span class="st">s]"</span>, <span class="st">" "</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove Extra Space</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_squish</span>() <span class="sc">|&gt;</span>  </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tokenize</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_split</span>(<span class="st">" "</span>) <span class="sc">|&gt;</span>                              </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove Stop Words</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">discard</span>(<span class="sc">~</span> .x <span class="sc">%in%</span> stop_words_data) <span class="sc">|&gt;</span>   </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Stem Worlds</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">wordStem</span>(<span class="at">language =</span> <span class="st">"en"</span>) <span class="sc">|&gt;</span>   </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combine Everything Back Into a String</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_c</span>(<span class="at">collapse =</span> <span class="st">" "</span>)                      </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>tidy_pokemon <span class="ot">&lt;-</span> pokedex <span class="sc">|&gt;</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">info =</span> <span class="fu">map_chr</span>(info, clean_text)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, there’s a lot of different ways that we can go about trying to use Pokedex entries to classify a Pokemon’s type. The simplest method is string matching and the logic is very intuitive. Basically, for each type, we define a set of key words/terms that are assumed to be heavily associated with a given Pokemon type. Then, if the string response for a Pokedex entry contains a keyword for a given type, we predict that Pokemon as being of that given type. Super simple, but not perfect. If we define our key words too narrowly, we run the risk of a lot of false negatives. In contrast, if we are very liberal with our definition of key words, we run the risk of predicting a lot of false positives.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Establish Keywords for Each Type</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>grass_keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"grass"</span>, <span class="st">"leaf"</span>, <span class="st">"tree"</span>, <span class="st">"plant"</span>, <span class="st">"seed"</span>, <span class="st">"bloom"</span>, <span class="st">"flower"</span>, <span class="st">"forest"</span>, <span class="st">"leav"</span>, <span class="st">"grow"</span>, <span class="st">"petal"</span>, <span class="st">"aroma"</span>, <span class="st">"fruit"</span>, <span class="st">"vine"</span>, <span class="st">"branch"</span>, <span class="st">"bud"</span>, <span class="st">"cotton"</span>, <span class="st">"appl"</span>, <span class="st">"root"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>fire_keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"fire"</span>, <span class="st">"hot"</span>, <span class="st">"flame"</span>, <span class="st">"burn"</span>, <span class="st">"ember"</span>, <span class="st">"heat"</span>, <span class="st">"fieri"</span>, <span class="st">"firebal"</span>, <span class="st">"fahrenheit"</span>, <span class="st">"magma"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>water_keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"water"</span>, <span class="st">"shell"</span>, <span class="st">"swim"</span>, <span class="st">"ocean"</span>, <span class="st">"sea"</span>, <span class="st">"fin"</span>, <span class="st">"bubbl"</span>, <span class="st">"depth"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>normal_keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"normal"</span>, <span class="st">"common"</span>, <span class="st">"fur"</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>electric_keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"electr"</span>, <span class="st">"light"</span>, <span class="st">"thunder"</span>, <span class="st">"lightn"</span>, <span class="st">"spark"</span>, <span class="st">"charg"</span>, <span class="st">"shock"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>ice_keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ice"</span>, <span class="st">"freez"</span>, <span class="st">"frozen"</span>, <span class="st">"snow"</span>, <span class="st">"ici"</span>, <span class="st">"cold"</span>, <span class="st">"snowi"</span>, <span class="st">"frigid"</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>fighting_keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"fight"</span>, <span class="st">"punch"</span>, <span class="st">"kick"</span>, <span class="st">"martial"</span>, <span class="st">"muscl"</span>, <span class="st">"strong"</span>, <span class="st">"strength"</span>, <span class="st">"fist"</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>poison_keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"poison"</span>, <span class="st">"venom"</span>, <span class="st">"sting"</span>, <span class="st">"toxic"</span>, <span class="st">"gas"</span>, <span class="st">"fluid"</span>, <span class="st">"acid"</span>, <span class="st">"spray"</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>ground_keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ground"</span>, <span class="st">"underground"</span>, <span class="st">"earthquak"</span>, <span class="st">"mud"</span>, <span class="st">"sand"</span>, <span class="st">"dig"</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>flying_keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"fli"</span>, <span class="st">"wing"</span>, <span class="st">"feather"</span>, <span class="st">"beak"</span>, <span class="st">"bird"</span>, <span class="st">"wind"</span>, <span class="st">"sky"</span>, <span class="st">"flap"</span>, <span class="st">"cloud"</span>, <span class="st">"air"</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>psychic_keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"psychic"</span>, <span class="st">"brain"</span>, <span class="st">"space"</span>, <span class="st">"control"</span>, <span class="st">"dream"</span>, <span class="st">"futur"</span>, <span class="st">"intellig"</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>bug_keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"bug"</span>, <span class="st">"silk"</span>, <span class="st">"stinger"</span>, <span class="st">"insect"</span>, <span class="st">"honey"</span>, <span class="st">"pollen"</span>, <span class="st">"shell"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>rock_keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"rock"</span>, <span class="st">"hard"</span>, <span class="st">"fossil"</span>, <span class="st">"ancient"</span>, <span class="st">"stone"</span>, <span class="st">"boulder"</span>, <span class="st">"coal"</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>ghost_keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ghost"</span>, <span class="st">"spirit"</span>, <span class="st">"curs"</span>, <span class="st">"soul"</span>, <span class="st">"possess"</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>dragon_keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"dragon"</span>, <span class="st">"scale"</span>, <span class="st">"power"</span>, <span class="st">"wing"</span>, <span class="st">"tusk"</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>dark_keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"dark"</span>, <span class="st">"night"</span>, <span class="st">"fear"</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>steel_keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"steel"</span>, <span class="st">"magnet"</span>, <span class="st">"iron"</span>, <span class="st">"metal"</span>, <span class="st">"armor"</span>, <span class="st">"hammer"</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>fairy_keys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"light"</span>, <span class="st">"fairi"</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a List of Types</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>types <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"grass"</span>, <span class="st">"fire"</span>, <span class="st">"water"</span>, <span class="st">"normal"</span>, <span class="st">"electric"</span>, <span class="st">"ice"</span>,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"fighting"</span>, <span class="st">"poison"</span>, <span class="st">"ground"</span>, <span class="st">"flying"</span>, <span class="st">"psychic"</span>, <span class="st">"bug"</span>,</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"rock"</span>, <span class="st">"ghost"</span>, <span class="st">"dragon"</span>, <span class="st">"dark"</span>, <span class="st">"steel"</span>, <span class="st">"fairy"</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Predictions Based on String Matching</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>sm_preds <span class="ot">&lt;-</span> tidy_pokemon <span class="sc">|&gt;</span> </span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"string_matching"</span>,</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">grass_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(grass_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">fire_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(fire_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(water_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">normal_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(normal_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">electric_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(electric_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">ice_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(ice_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">fighting_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(fighting_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">poison_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(poison_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">ground_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(ground_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">flying_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(flying_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">psychic_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(psychic_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">bug_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(bug_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">rock_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(rock_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">ghost_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(ghost_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">dragon_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(dragon_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">dark_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(dark_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">steel_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(steel_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">fairy_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(fairy_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an Empty Data Frame to Store Results</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>string_matching_metrics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop Through Each Type for Predictive Metrics</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (type <span class="cf">in</span> types) {</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>  match_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(type, <span class="st">"_match"</span>)</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>  true_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"type_"</span>, type)</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>  true <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(sm_preds[[true_col]] <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"yes"</span>, <span class="st">"no"</span>))</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>  predicted <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(sm_preds[[match_col]] <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"yes"</span>, <span class="st">"no"</span>))</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Confusion Matrix</span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>  cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(predicted, true, <span class="at">positive =</span> <span class="st">"yes"</span>)</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store Metrics</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>  string_matching_metrics <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(string_matching_metrics, <span class="fu">data.frame</span>(</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> type,</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">sensitivity =</span> cm<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>],</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">specificity =</span> cm<span class="sc">$</span>byClass[<span class="st">"Specificity"</span>],</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">predictors =</span> <span class="st">"string_matching"</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>But perhaps if we use a bit more of a complicated method, it will be able to navigate the nuances of the data to navigate this tricky balance. To investigate this, I am using a topic modeling algorithm known as seeded Latent Dirichlet Allocation (SLDA), developed by <a href="https://journals.sagepub.com/doi/10.1177/08944393231178605">Watanabe and Baturo (2024)</a>. To understand how this works, consider the basic Latent Dirichlet Allocation (LDA) model, a <em>very</em> popular, if not limited, topic modeling approach. LDA assumes that each text entry in a corpus of documents represents some mixture of topics. For example, if we have topics A, B, C, and D, then the contents of Document X could be 20% from Topic A, 50% from Topic B, 25% from Topic C, and 5% from Topic D. Furthermore, each topic itself is a mixture of words. If we are looking at a cooking manual and Topic A is “Baking” then some of the words that might contribute to Topic A might be “baking”, “oven”, “cookies”, “pre-heat”, etc. But, there’s a noticeable problem with LDA.</p>
<p>When executing LDA, the user simply tells the algorithm how many topics to look for (<span class="math inline">\(k\)</span> = 4? 8? 100?). There is no <em>right</em> answer for how many topics there truly are, so there’s some educated guesswork to this. This itself is not a fundamental problem for LDA, but the <em>actual</em> core issue is that standard LDA has no way of telling the user what each topic is. Topic 1 is simply Topic 1 and it’s up to the user to figure out what that topic is actually about. Further, if a corpus truly only consists of 4 topics, but you tell the LDA algorithm to search for 10, it will sure enough find 10, even though 10 topics do not exist, so have fun interpreting your results and making sense of the topics it spits back out at you.</p>
<p>A lot of researchers in NLP have extended the LDA algorithm, either by enhancing the model directly or developing entirely different topics models. For this blog, I will be working with seeded LDA which really helps to overcome the problem of the algorithm being agnostic on the <em>types</em> of topics in the corpus. This is very useful when you already know <em>what</em> the topics are in a corpus, you just don’t know which topics each and every document in the corpus belongs to. And the <code>{seededlda}</code> R package makes this all very simple. Much like string matching, you can just supply key words/terms to the algorithm to define both the number of topics that the algorithm will look for, but also to strongly inform what those topics are. For example, I am telling the algorithm that “grass” is a topic and the following words (“grass”, “leaf”, “tree”, “plant”, “seed”, “bloom”, “flower”, “forest”) are key components to that topic. With these “seeds” supplied for each type, I will get<span class="math inline">\(\theta\)</span> (theta) values back, which tell me the predicted topic distribution for each Pokemon.</p>
<p>But what are you actually supposed to <em>do</em> with these <span class="math inline">\(\theta\)</span> values? I don’t think there’s anything tried and true (please correct me if I’m wrong), so I’m going to look at a lot of different things. A simple approach is to develop a simple classification rule using the <span class="math inline">\(\theta\)</span> values. For example, let’s say we’ve ran our SLDA algorithm and get <span class="math inline">\(\theta\)</span> values for each type of Bulbasaur. Let’s say they look something like this for the highest 5 <span class="math inline">\(\theta\)</span> values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mock_slda <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Type (Topic)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Grass"</span>, <span class="st">"Poison"</span>, <span class="st">"Bug"</span>, <span class="st">"Fairy"</span>, <span class="st">"Normal"</span>),</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Theta</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.46</span>, <span class="fl">0.29</span>, <span class="fl">0.07</span>, <span class="fl">0.02</span>, <span class="fl">0.001</span>),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tt</span>(mock_slda) <span class="sc">|&gt;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">style_tt</span>(<span class="at">align =</span> <span class="st">"c"</span>)                    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_ovg4s4lvb1r8hvpcjvxf(i, j, css_id) {
          var table = document.getElementById("tinytable_ovg4s4lvb1r8hvpcjvxf");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_ovg4s4lvb1r8hvpcjvxf');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_ovg4s4lvb1r8hvpcjvxf(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_ovg4s4lvb1r8hvpcjvxf");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 5, j: 0 }, { i: 5, j: 1 },  ], css_id: 'tinytable_css_0fl54m2gmgyte9y0ktb2',}, 
          { positions: [ { i: 1, j: 0 }, { i: 3, j: 0 }, { i: 4, j: 0 }, { i: 3, j: 1 }, { i: 2, j: 0 }, { i: 1, j: 1 }, { i: 2, j: 1 }, { i: 4, j: 1 },  ], css_id: 'tinytable_css_7jihvvjijfyg6bbrtekk',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 },  ], css_id: 'tinytable_css_mmgjezi2almimtzjxeh1',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_ovg4s4lvb1r8hvpcjvxf(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_0fl54m2gmgyte9y0ktb2, .table th.tinytable_css_0fl54m2gmgyte9y0ktb2 { text-align: center; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_7jihvvjijfyg6bbrtekk, .table th.tinytable_css_7jihvvjijfyg6bbrtekk { text-align: center; }
      .table td.tinytable_css_mmgjezi2almimtzjxeh1, .table th.tinytable_css_mmgjezi2almimtzjxeh1 { text-align: center; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_ovg4s4lvb1r8hvpcjvxf" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Type (Topic)</th>
                <th scope="col">Theta</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>Grass</td>
                  <td>0.460</td>
                </tr>
                <tr>
                  <td>Poison</td>
                  <td>0.290</td>
                </tr>
                <tr>
                  <td>Bug</td>
                  <td>0.070</td>
                </tr>
                <tr>
                  <td>Fairy</td>
                  <td>0.020</td>
                </tr>
                <tr>
                  <td>Normal</td>
                  <td>0.001</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p>Since we know Pokemon, these mock results make sense. These results tell us that 75% of Bulbasaur’s Pokedex entry comes from either the grass or the poison type. But how do we make predictions based on this? One idea is to just define an arbitrary classification rule using the theta value. For example, we could say that, for a each type, if <span class="math inline">\(\theta\)</span> &gt;= 0.5, then we assign it to that type. But, such a rule is very punitive when the algorithm is uncertain and spreads <span class="math inline">\(\theta\)</span> across a lot of types. Further, for dual types, it is systematically biased since the distribution <em>should</em> be more evenly split. A way around this is to just lower the cut-off, i.e.&nbsp;<span class="math inline">\(\theta\)</span> &gt;= 0.4, <span class="math inline">\(\theta\)</span> &gt;= 0.3, etc. So, that’s what I do. I’ll be evaluating one strategy by using SLDA <span class="math inline">\(\theta\)</span> values and assign three very simple classification rules.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Tokenize the Data for SLDA</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>tokens <span class="ot">&lt;-</span> tidy_pokemon <span class="sc">|&gt;</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_tokens</span>(word, info) </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Cast a DFM</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>dfm <span class="ot">&lt;-</span> tokens <span class="sc">|&gt;</span> </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(id, word) <span class="sc">|&gt;</span> </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cast_dfm</span>(id, word, n)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Seeds</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>lda_seeds <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">dictionary</span>(<span class="fu">list</span>(</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">grass =</span> grass_keys,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">fire =</span> fire_keys,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">water =</span> water_keys,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">normal =</span> normal_keys,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">electric =</span> electric_keys,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">ice =</span> ice_keys,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">fighting =</span> fighting_keys,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">poison =</span> poison_keys,</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">ground =</span> ground_keys,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">flying =</span> flying_keys,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">psychic =</span> psychic_keys,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">bug =</span> bug_keys,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">rock =</span> rock_keys,</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">ghost =</span> ghost_keys,</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">dragon =</span> dragon_keys,</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">dark =</span> dark_keys,</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">steel =</span> steel_keys,</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">fairy =</span> fairy_keys</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>seeded_lda <span class="ot">&lt;-</span> <span class="fu">textmodel_seededlda</span>(dfm, lda_seeds)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Thetas from SLDA</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>slda_theta <span class="ot">&lt;-</span> seeded_lda<span class="sc">$</span>theta <span class="sc">|&gt;</span> </span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">as.integer</span>(id)) <span class="sc">|&gt;</span> </span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tidy_pokemon, <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Predictions with SLDA 30% Rule</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>slda30_preds <span class="ot">&lt;-</span> slda_theta <span class="sc">|&gt;</span> </span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"SLDA_30%"</span>,</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">grass_match_slda_30 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(grass_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> grass <span class="sc">&gt;=</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">fire_match_slda_30 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(fire_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> fire <span class="sc">&gt;=</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_match_slda_30 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(water_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> water <span class="sc">&gt;=</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">normal_match_slda_30 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(normal_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> normal <span class="sc">&gt;=</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">electric_match_slda_30 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(electric_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> electric <span class="sc">&gt;=</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">ice_match_slda_30 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(ice_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> ice <span class="sc">&gt;=</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">fighting_match_slda_30 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(fighting_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> fighting <span class="sc">&gt;=</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">poison_match_slda_30 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(poison_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> poison <span class="sc">&gt;=</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">ground_match_slda_30 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(ground_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> ground <span class="sc">&gt;=</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">flying_match_slda_30 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(flying_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> flying <span class="sc">&gt;=</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">psychic_match_slda_30 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(psychic_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> psychic <span class="sc">&gt;=</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">bug_match_slda_30 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(bug_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> bug <span class="sc">&gt;=</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">rock_match_slda_30 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(rock_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> rock <span class="sc">&gt;=</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">ghost_match_slda_30 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(ghost_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> ghost <span class="sc">&gt;=</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">dragon_match_slda_30 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(dragon_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> dragon <span class="sc">&gt;=</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">dark_match_slda_30 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(dark_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> dark <span class="sc">&gt;=</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">steel_match_slda_30 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(steel_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> steel <span class="sc">&gt;=</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">fairy_match_slda_30 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(fairy_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> fairy <span class="sc">&gt;=</span> <span class="fl">0.3</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an Empty Data Frame to Store Results</span></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>theta_30_sm_metrics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop Through Each Type for Predictive Metrics</span></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (type <span class="cf">in</span> types) {</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>  match_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(type, <span class="st">"_match_slda_30"</span>)</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>  true_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"type_"</span>, type)</span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>  true <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(slda30_preds[[true_col]] <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"yes"</span>, <span class="st">"no"</span>))</span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>  predicted <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(slda30_preds[[match_col]] <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"yes"</span>, <span class="st">"no"</span>))</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Confusion Matrix</span></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>  cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(predicted, true, <span class="at">positive =</span> <span class="st">"yes"</span>)</span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store Metrics</span></span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>  theta_30_sm_metrics <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(theta_30_sm_metrics, <span class="fu">data.frame</span>(</span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> type,</span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">sensitivity =</span> cm<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>],</span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">specificity =</span> cm<span class="sc">$</span>byClass[<span class="st">"Specificity"</span>],</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">predictors =</span> <span class="st">"SLDA_30"</span></span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Predictions with SLDA 40% Rule</span></span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>slda40_preds <span class="ot">&lt;-</span> slda_theta <span class="sc">|&gt;</span> </span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"SLDA_40%"</span>,</span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">grass_match_slda_40 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(grass_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> grass <span class="sc">&gt;=</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">fire_match_slda_40 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(fire_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> fire <span class="sc">&gt;=</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_match_slda_40 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(water_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> water <span class="sc">&gt;=</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">normal_match_slda_40 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(normal_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> normal <span class="sc">&gt;=</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">electric_match_slda_40 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(electric_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> electric <span class="sc">&gt;=</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">ice_match_slda_40 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(ice_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> ice <span class="sc">&gt;=</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">fighting_match_slda_40 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(fighting_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> fighting <span class="sc">&gt;=</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">poison_match_slda_40 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(poison_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> poison <span class="sc">&gt;=</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">ground_match_slda_40 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(ground_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> ground <span class="sc">&gt;=</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">flying_match_slda_40 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(flying_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> flying <span class="sc">&gt;=</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">psychic_match_slda_40 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(psychic_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> psychic <span class="sc">&gt;=</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">bug_match_slda_40 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(bug_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> bug <span class="sc">&gt;=</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">rock_match_slda_40 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(rock_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> rock <span class="sc">&gt;=</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">ghost_match_slda_40 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(ghost_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> ghost <span class="sc">&gt;=</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">dragon_match_slda_40 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(dragon_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> dragon <span class="sc">&gt;=</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">dark_match_slda_40 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(dark_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> dark <span class="sc">&gt;=</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">steel_match_slda_40 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(steel_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> steel <span class="sc">&gt;=</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">fairy_match_slda_40 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(fairy_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> fairy <span class="sc">&gt;=</span> <span class="fl">0.4</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an Empty Data Frame to Store Results</span></span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>theta_40_sm_metrics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop Through Each Type for Predictive Metrics</span></span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (type <span class="cf">in</span> types) {</span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a>  match_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(type, <span class="st">"_match_slda_40"</span>)</span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a>  true_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"type_"</span>, type)</span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a>  true <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(slda40_preds[[true_col]] <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"yes"</span>, <span class="st">"no"</span>))</span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a>  predicted <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(slda40_preds[[match_col]] <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"yes"</span>, <span class="st">"no"</span>))</span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Confusion Matrix</span></span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a>  cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(predicted, true, <span class="at">positive =</span> <span class="st">"yes"</span>)</span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store Metrics</span></span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a>  theta_40_sm_metrics <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(theta_40_sm_metrics, <span class="fu">data.frame</span>(</span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> type,</span>
<span id="cb7-133"><a href="#cb7-133" aria-hidden="true" tabindex="-1"></a>    <span class="at">sensitivity =</span> cm<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>],</span>
<span id="cb7-134"><a href="#cb7-134" aria-hidden="true" tabindex="-1"></a>    <span class="at">specificity =</span> cm<span class="sc">$</span>byClass[<span class="st">"Specificity"</span>],</span>
<span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">predictors =</span> <span class="st">"SLDA_40"</span></span>
<span id="cb7-136"><a href="#cb7-136" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb7-137"><a href="#cb7-137" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-138"><a href="#cb7-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-139"><a href="#cb7-139" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Predictions with SLDA 50% Rule</span></span>
<span id="cb7-140"><a href="#cb7-140" aria-hidden="true" tabindex="-1"></a>slda50_preds <span class="ot">&lt;-</span> slda_theta <span class="sc">|&gt;</span> </span>
<span id="cb7-141"><a href="#cb7-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-142"><a href="#cb7-142" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"SLDA_50%"</span>,</span>
<span id="cb7-143"><a href="#cb7-143" aria-hidden="true" tabindex="-1"></a>    <span class="at">grass_match_slda_50 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(grass_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> grass <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-144"><a href="#cb7-144" aria-hidden="true" tabindex="-1"></a>    <span class="at">fire_match_slda_50 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(fire_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> fire <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-145"><a href="#cb7-145" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_match_slda_50 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(water_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> water <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-146"><a href="#cb7-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">normal_match_slda_50 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(normal_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> normal <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-147"><a href="#cb7-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">electric_match_slda_50 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(electric_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> electric <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-148"><a href="#cb7-148" aria-hidden="true" tabindex="-1"></a>    <span class="at">ice_match_slda_50 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(ice_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> ice <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-149"><a href="#cb7-149" aria-hidden="true" tabindex="-1"></a>    <span class="at">fighting_match_slda_50 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(fighting_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> fighting <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-150"><a href="#cb7-150" aria-hidden="true" tabindex="-1"></a>    <span class="at">poison_match_slda_50 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(poison_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> poison <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-151"><a href="#cb7-151" aria-hidden="true" tabindex="-1"></a>    <span class="at">ground_match_slda_50 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(ground_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> ground <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-152"><a href="#cb7-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">flying_match_slda_50 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(flying_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> flying <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-153"><a href="#cb7-153" aria-hidden="true" tabindex="-1"></a>    <span class="at">psychic_match_slda_50 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(psychic_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> psychic <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-154"><a href="#cb7-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">bug_match_slda_50 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(bug_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> bug <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-155"><a href="#cb7-155" aria-hidden="true" tabindex="-1"></a>    <span class="at">rock_match_slda_50 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(rock_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> rock <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-156"><a href="#cb7-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">ghost_match_slda_50 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(ghost_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> ghost <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-157"><a href="#cb7-157" aria-hidden="true" tabindex="-1"></a>    <span class="at">dragon_match_slda_50 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(dragon_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> dragon <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-158"><a href="#cb7-158" aria-hidden="true" tabindex="-1"></a>    <span class="at">dark_match_slda_50 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(dark_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> dark <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-159"><a href="#cb7-159" aria-hidden="true" tabindex="-1"></a>    <span class="at">steel_match_slda_50 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(steel_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> steel <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb7-160"><a href="#cb7-160" aria-hidden="true" tabindex="-1"></a>    <span class="at">fairy_match_slda_50 =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(fairy_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)) <span class="sc">|</span> fairy <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb7-161"><a href="#cb7-161" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-162"><a href="#cb7-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-163"><a href="#cb7-163" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an Empty Data Frame to Store Results</span></span>
<span id="cb7-164"><a href="#cb7-164" aria-hidden="true" tabindex="-1"></a>theta_50_sm_metrics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb7-165"><a href="#cb7-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-166"><a href="#cb7-166" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop Through Each Type for Predictive Metrics</span></span>
<span id="cb7-167"><a href="#cb7-167" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (type <span class="cf">in</span> types) {</span>
<span id="cb7-168"><a href="#cb7-168" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-169"><a href="#cb7-169" aria-hidden="true" tabindex="-1"></a>  match_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(type, <span class="st">"_match_slda_50"</span>)</span>
<span id="cb7-170"><a href="#cb7-170" aria-hidden="true" tabindex="-1"></a>  true_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"type_"</span>, type)</span>
<span id="cb7-171"><a href="#cb7-171" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-172"><a href="#cb7-172" aria-hidden="true" tabindex="-1"></a>  true <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(slda50_preds[[true_col]] <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"yes"</span>, <span class="st">"no"</span>))</span>
<span id="cb7-173"><a href="#cb7-173" aria-hidden="true" tabindex="-1"></a>  predicted <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(slda50_preds[[match_col]] <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"yes"</span>, <span class="st">"no"</span>))</span>
<span id="cb7-174"><a href="#cb7-174" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-175"><a href="#cb7-175" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Confusion Matrix</span></span>
<span id="cb7-176"><a href="#cb7-176" aria-hidden="true" tabindex="-1"></a>  cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(predicted, true, <span class="at">positive =</span> <span class="st">"yes"</span>)</span>
<span id="cb7-177"><a href="#cb7-177" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-178"><a href="#cb7-178" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store Metrics</span></span>
<span id="cb7-179"><a href="#cb7-179" aria-hidden="true" tabindex="-1"></a>  theta_50_sm_metrics <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(theta_50_sm_metrics, <span class="fu">data.frame</span>(</span>
<span id="cb7-180"><a href="#cb7-180" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> type,</span>
<span id="cb7-181"><a href="#cb7-181" aria-hidden="true" tabindex="-1"></a>    <span class="at">sensitivity =</span> cm<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>],</span>
<span id="cb7-182"><a href="#cb7-182" aria-hidden="true" tabindex="-1"></a>    <span class="at">specificity =</span> cm<span class="sc">$</span>byClass[<span class="st">"Specificity"</span>],</span>
<span id="cb7-183"><a href="#cb7-183" aria-hidden="true" tabindex="-1"></a>    <span class="at">predictors =</span> <span class="st">"SLDA_50"</span></span>
<span id="cb7-184"><a href="#cb7-184" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb7-185"><a href="#cb7-185" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Alternatively, we could just plug the <span class="math inline">\(\theta\)</span> values into a machine learning algorithm and hope that it can pick up on some added nuance in assigning classifications, so we’ll give that a try as well.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Establish the Cross Validation Parameters</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"cv"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">number =</span> <span class="dv">5</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">classProbs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">summaryFunction =</span> twoClassSummary,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">savePredictions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">sampling =</span> <span class="st">"smote"</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>type_cols <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"type_"</span>, <span class="fu">c</span>(</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"normal"</span>, <span class="st">"fire"</span>, <span class="st">"water"</span>, <span class="st">"grass"</span>, <span class="st">"electric"</span>, <span class="st">"ice"</span>, <span class="st">"fighting"</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"poison"</span>, <span class="st">"ground"</span>, <span class="st">"flying"</span>, <span class="st">"psychic"</span>, <span class="st">"bug"</span>, <span class="st">"rock"</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ghost"</span>, <span class="st">"dragon"</span>, <span class="st">"dark"</span>, <span class="st">"steel"</span>, <span class="st">"fairy"</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre Learning Cleaning</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>slda_theta <span class="ot">&lt;-</span> slda_theta <span class="sc">|&gt;</span> </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert All Outcomes to Factors</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(type_cols), <span class="sc">~</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(. <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"no"</span>, <span class="st">"yes"</span>))))</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Each Model</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>grass_model_thetas <span class="ot">&lt;-</span> <span class="fu">train</span>(type_grass <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>fire_model_thetas <span class="ot">&lt;-</span> <span class="fu">train</span>(type_fire <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>water_model_thetas <span class="ot">&lt;-</span> <span class="fu">train</span>(type_water <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>normal_model_thetas <span class="ot">&lt;-</span> <span class="fu">train</span>(type_normal <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>electric_model_thetas <span class="ot">&lt;-</span> <span class="fu">train</span>(type_electric <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>ice_model_thetas <span class="ot">&lt;-</span> <span class="fu">train</span>(type_ice <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>fighting_model_thetas <span class="ot">&lt;-</span> <span class="fu">train</span>(type_fighting <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>poison_model_thetas <span class="ot">&lt;-</span> <span class="fu">train</span>(type_poison <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>ground_model_thetas <span class="ot">&lt;-</span> <span class="fu">train</span>(type_ground <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>flying_model_thetas <span class="ot">&lt;-</span> <span class="fu">train</span>(type_flying <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>psychic_model_thetas <span class="ot">&lt;-</span> <span class="fu">train</span>(type_psychic <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>bug_model_thetas <span class="ot">&lt;-</span> <span class="fu">train</span>(type_bug <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>rock_model_thetas <span class="ot">&lt;-</span> <span class="fu">train</span>(type_rock <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>ghost_model_thetas <span class="ot">&lt;-</span> <span class="fu">train</span>(type_ghost <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>dragon_model_thetas <span class="ot">&lt;-</span> <span class="fu">train</span>(type_dragon <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>dark_model_thetas <span class="ot">&lt;-</span> <span class="fu">train</span>(type_dark <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>steel_model_thetas <span class="ot">&lt;-</span> <span class="fu">train</span>(type_steel <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>fairy_model_thetas <span class="ot">&lt;-</span> <span class="fu">train</span>(type_fairy <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Store Models in a List</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>model_list_thetas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">grass =</span> grass_model_thetas,</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">fire =</span> fire_model_thetas,</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">water =</span> water_model_thetas,</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">normal =</span> normal_model_thetas,</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">electric =</span> electric_model_thetas,</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">ice =</span> ice_model_thetas,</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">fighting =</span> fighting_model_thetas,</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">poison =</span> poison_model_thetas,</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">ground =</span> ground_model_thetas,</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">flying =</span> flying_model_thetas,</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">psychic =</span> psychic_model_thetas,</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">bug =</span> bug_model_thetas,</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">rock =</span> rock_model_thetas,</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">ghost =</span> ghost_model_thetas,</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">dragon =</span> dragon_model_thetas,</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">dark =</span> dark_model_thetas,</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">steel =</span> steel_model_thetas,</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">fairy =</span> fairy_model_thetas</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an Empty Data Frame to Store Results</span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>theta_model_metrics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop Through Each Model</span></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (type <span class="cf">in</span> <span class="fu">names</span>(model_list_thetas)) {</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> model_list_thetas[[type]]</span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get Best Tuning Parameters</span></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>  best_mtry <span class="ot">&lt;-</span> model<span class="sc">$</span>bestTune<span class="sc">$</span>mtry</span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>  preds_best <span class="ot">&lt;-</span> model<span class="sc">$</span>pred <span class="sc">|&gt;</span> <span class="fu">filter</span>(mtry <span class="sc">==</span> best_mtry)</span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Confusion Matrix</span></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>  cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(preds_best<span class="sc">$</span>pred, preds_best<span class="sc">$</span>obs, <span class="at">positive =</span> <span class="st">"yes"</span>)</span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store Metrics</span></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>  theta_model_metrics <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(theta_model_metrics, <span class="fu">data.frame</span>(</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> type,</span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">sensitivity =</span> cm<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>],</span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">specificity =</span> cm<span class="sc">$</span>byClass[<span class="st">"Specificity"</span>],</span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">predictors =</span> <span class="st">"thetas_only"</span></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the event that <span class="math inline">\(\theta\)</span> values alone aren’t sufficient, maybe it’s possible that adding a binary indicator for string matches <em>alongside</em> <span class="math inline">\(\theta\)</span> values as predictors in a machine learning algorithm aids in predictive accuracy, so I’m going to give that a shot as well.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add String Matches to Theta Data Frame</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>slda_theta <span class="ot">&lt;-</span> slda_theta <span class="sc">|&gt;</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">grass_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(grass_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fire_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(fire_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(water_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">normal_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(normal_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">electric_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(electric_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ice_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(ice_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fighting_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(fighting_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">poison_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(poison_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ground_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(ground_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">flying_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(flying_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">psychic_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(psychic_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">bug_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(bug_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">rock_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(rock_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">ghost_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(ghost_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">dragon_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(dragon_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">dark_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(dark_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">steel_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(steel_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">fairy_match =</span> <span class="fu">if_else</span>(<span class="fu">str_detect</span>(info, <span class="fu">str_c</span>(fairy_keys, <span class="at">collapse =</span> <span class="st">"|"</span>)), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Models</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>grass_model_thetas_sm <span class="ot">&lt;-</span> <span class="fu">train</span>(type_grass <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> grass_match, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>fire_model_thetas_sm <span class="ot">&lt;-</span> <span class="fu">train</span>(type_fire <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> fire_match, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>water_model_thetas_sm <span class="ot">&lt;-</span> <span class="fu">train</span>(type_water <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> water_match, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>normal_model_thetas_sm <span class="ot">&lt;-</span> <span class="fu">train</span>(type_normal <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> normal_match, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>electric_model_thetas_sm <span class="ot">&lt;-</span> <span class="fu">train</span>(type_electric <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> electric_match, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>ice_model_thetas_sm <span class="ot">&lt;-</span> <span class="fu">train</span>(type_ice <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> ice_match, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>fighting_model_thetas_sm <span class="ot">&lt;-</span> <span class="fu">train</span>(type_fighting <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> fighting_match, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>poison_model_thetas_sm <span class="ot">&lt;-</span> <span class="fu">train</span>(type_poison <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> poison_match, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>ground_model_thetas_sm <span class="ot">&lt;-</span> <span class="fu">train</span>(type_ground <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> ground_match, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>flying_model_thetas_sm <span class="ot">&lt;-</span> <span class="fu">train</span>(type_flying <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> flying_match, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>psychic_model_thetas_sm <span class="ot">&lt;-</span> <span class="fu">train</span>(type_psychic <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> psychic_match, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>bug_model_thetas_sm <span class="ot">&lt;-</span> <span class="fu">train</span>(type_bug <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> bug_match, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>rock_model_thetas_sm <span class="ot">&lt;-</span> <span class="fu">train</span>(type_rock <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> rock_match, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>ghost_model_thetas_sm <span class="ot">&lt;-</span> <span class="fu">train</span>(type_ghost <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> ghost_match, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>dragon_model_thetas_sm <span class="ot">&lt;-</span> <span class="fu">train</span>(type_dragon <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> dragon_match, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>dark_model_thetas_sm <span class="ot">&lt;-</span> <span class="fu">train</span>(type_dark <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> dark_match, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>steel_model_thetas_sm <span class="ot">&lt;-</span> <span class="fu">train</span>(type_steel <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> steel_match, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>fairy_model_thetas_sm <span class="ot">&lt;-</span> <span class="fu">train</span>(type_fairy <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> fairy_match, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Store Models in a List</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>model_list_thetas_sm <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">grass =</span> grass_model_thetas_sm,</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">fire =</span> fire_model_thetas_sm,</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">water =</span> water_model_thetas_sm,</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">normal =</span> normal_model_thetas_sm,</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">electric =</span> electric_model_thetas_sm,</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">ice =</span> ice_model_thetas_sm,</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">fighting =</span> fighting_model_thetas_sm,</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">poison =</span> poison_model_thetas_sm,</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">ground =</span> ground_model_thetas_sm,</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">flying =</span> flying_model_thetas_sm,</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">psychic =</span> psychic_model_thetas_sm,</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">bug =</span> bug_model_thetas_sm,</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">rock =</span> rock_model_thetas_sm,</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">ghost =</span> ghost_model_thetas_sm,</span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">dragon =</span> dragon_model_thetas_sm,</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">dark =</span> dark_model_thetas_sm,</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">steel =</span> steel_model_thetas_sm,</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">fairy =</span> fairy_model_thetas_sm</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an Empty Data Frame to Store Results</span></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>theta_sm_model_metrics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>() </span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop Through Each Model</span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (type <span class="cf">in</span> <span class="fu">names</span>(model_list_thetas_sm)) {</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> model_list_thetas_sm[[type]]</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get Best Tuning Parameters</span></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>  best_mtry <span class="ot">&lt;-</span> model<span class="sc">$</span>bestTune<span class="sc">$</span>mtry</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>  preds_best <span class="ot">&lt;-</span> model<span class="sc">$</span>pred <span class="sc">|&gt;</span> <span class="fu">filter</span>(mtry <span class="sc">==</span> best_mtry)</span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Confusion Matrix</span></span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>  cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(preds_best<span class="sc">$</span>pred, preds_best<span class="sc">$</span>obs, <span class="at">positive =</span> <span class="st">"yes"</span>)</span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract Metrics</span></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>  theta_sm_model_metrics <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(theta_sm_model_metrics, <span class="fu">data.frame</span>(</span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> type,</span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">sensitivity =</span> cm<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>],</span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">specificity =</span> cm<span class="sc">$</span>byClass[<span class="st">"Specificity"</span>],</span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">predictors =</span> <span class="st">"thetas_and_string_matching"</span></span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lastly, maybe predictions can be enhanced if, alongside <span class="math inline">\(\theta\)</span> values and string matching dummies, we include Pokemon statistics as predictors (HP, attack, defense, speed, etc.). Speed is heavily associated with types like electric, flying, rock, and steel. Types like psychic, electric, and ghost tend to have higher special attack statistics. So maybe including these as predictors could be helpful.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Models</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>grass_model_thetas_sm_stats <span class="ot">&lt;-</span> <span class="fu">train</span>(type_grass <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> grass_match <span class="sc">+</span> hp <span class="sc">+</span> attack <span class="sc">+</span> defense <span class="sc">+</span> s_attack <span class="sc">+</span> s_defense <span class="sc">+</span> speed, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>fire_model_thetas_sm_stats <span class="ot">&lt;-</span> <span class="fu">train</span>(type_fire <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> fire_match <span class="sc">+</span> hp <span class="sc">+</span> attack <span class="sc">+</span> defense <span class="sc">+</span> s_attack <span class="sc">+</span> s_defense <span class="sc">+</span> speed, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>water_model_thetas_sm_stats <span class="ot">&lt;-</span> <span class="fu">train</span>(type_water <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> water_match <span class="sc">+</span> hp <span class="sc">+</span> attack <span class="sc">+</span> defense <span class="sc">+</span> s_attack <span class="sc">+</span> s_defense <span class="sc">+</span> speed, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>normal_model_thetas_sm_stats <span class="ot">&lt;-</span> <span class="fu">train</span>(type_normal <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> normal_match <span class="sc">+</span> hp <span class="sc">+</span> attack <span class="sc">+</span> defense <span class="sc">+</span> s_attack <span class="sc">+</span> s_defense <span class="sc">+</span> speed, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>electric_model_thetas_sm_stats <span class="ot">&lt;-</span> <span class="fu">train</span>(type_electric <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> electric_match <span class="sc">+</span> hp <span class="sc">+</span> attack <span class="sc">+</span> defense <span class="sc">+</span> s_attack <span class="sc">+</span> s_defense <span class="sc">+</span> speed, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>ice_model_thetas_sm_stats <span class="ot">&lt;-</span> <span class="fu">train</span>(type_ice <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> ice_match <span class="sc">+</span> hp <span class="sc">+</span> attack <span class="sc">+</span> defense <span class="sc">+</span> s_attack <span class="sc">+</span> s_defense <span class="sc">+</span> speed, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>fighting_model_thetas_sm_stats <span class="ot">&lt;-</span> <span class="fu">train</span>(type_fighting <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> fighting_match <span class="sc">+</span> hp <span class="sc">+</span> attack <span class="sc">+</span> defense <span class="sc">+</span> s_attack <span class="sc">+</span> s_defense <span class="sc">+</span> speed, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>poison_model_thetas_sm_stats <span class="ot">&lt;-</span> <span class="fu">train</span>(type_poison <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> poison_match <span class="sc">+</span> hp <span class="sc">+</span> attack <span class="sc">+</span> defense <span class="sc">+</span> s_attack <span class="sc">+</span> s_defense <span class="sc">+</span> speed, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>ground_model_thetas_sm_stats <span class="ot">&lt;-</span> <span class="fu">train</span>(type_ground <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> ground_match <span class="sc">+</span> hp <span class="sc">+</span> attack <span class="sc">+</span> defense <span class="sc">+</span> s_attack <span class="sc">+</span> s_defense <span class="sc">+</span> speed, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>flying_model_thetas_sm_stats <span class="ot">&lt;-</span> <span class="fu">train</span>(type_flying <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> flying_match <span class="sc">+</span> hp <span class="sc">+</span> attack <span class="sc">+</span> defense <span class="sc">+</span> s_attack <span class="sc">+</span> s_defense <span class="sc">+</span> speed, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>psychic_model_thetas_sm_stats <span class="ot">&lt;-</span> <span class="fu">train</span>(type_psychic <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> psychic_match <span class="sc">+</span> hp <span class="sc">+</span> attack <span class="sc">+</span> defense <span class="sc">+</span> s_attack <span class="sc">+</span> s_defense <span class="sc">+</span> speed, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>bug_model_thetas_sm_stats <span class="ot">&lt;-</span> <span class="fu">train</span>(type_bug <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> bug_match <span class="sc">+</span> hp <span class="sc">+</span> attack <span class="sc">+</span> defense <span class="sc">+</span> s_attack <span class="sc">+</span> s_defense <span class="sc">+</span> speed, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>rock_model_thetas_sm_stats <span class="ot">&lt;-</span> <span class="fu">train</span>(type_rock <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> rock_match <span class="sc">+</span> hp <span class="sc">+</span> attack <span class="sc">+</span> defense <span class="sc">+</span> s_attack <span class="sc">+</span> s_defense <span class="sc">+</span> speed, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>ghost_model_thetas_sm_stats <span class="ot">&lt;-</span> <span class="fu">train</span>(type_ghost <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> ghost_match <span class="sc">+</span> hp <span class="sc">+</span> attack <span class="sc">+</span> defense <span class="sc">+</span> s_attack <span class="sc">+</span> s_defense <span class="sc">+</span> speed, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>dragon_model_thetas_sm_stats <span class="ot">&lt;-</span> <span class="fu">train</span>(type_dragon <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> dragon_match <span class="sc">+</span> hp <span class="sc">+</span> attack <span class="sc">+</span> defense <span class="sc">+</span> s_attack <span class="sc">+</span> s_defense <span class="sc">+</span> speed, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>dark_model_thetas_sm_stats <span class="ot">&lt;-</span> <span class="fu">train</span>(type_dark <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> dark_match <span class="sc">+</span> hp <span class="sc">+</span> attack <span class="sc">+</span> defense <span class="sc">+</span> s_attack <span class="sc">+</span> s_defense <span class="sc">+</span> speed, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>steel_model_thetas_sm_stats <span class="ot">&lt;-</span> <span class="fu">train</span>(type_steel <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> steel_match <span class="sc">+</span> hp <span class="sc">+</span> attack <span class="sc">+</span> defense <span class="sc">+</span> s_attack <span class="sc">+</span> s_defense <span class="sc">+</span> speed, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>fairy_model_thetas_sm_stats <span class="ot">&lt;-</span> <span class="fu">train</span>(type_fairy <span class="sc">~</span> grass <span class="sc">+</span> fire <span class="sc">+</span> water <span class="sc">+</span> electric <span class="sc">+</span> normal <span class="sc">+</span> ice <span class="sc">+</span> fighting <span class="sc">+</span> poison <span class="sc">+</span> ground <span class="sc">+</span> flying <span class="sc">+</span> psychic <span class="sc">+</span> bug <span class="sc">+</span> rock <span class="sc">+</span> ghost <span class="sc">+</span> dragon <span class="sc">+</span> dark <span class="sc">+</span> steel <span class="sc">+</span> fairy <span class="sc">+</span> fairy_match <span class="sc">+</span> hp <span class="sc">+</span> attack <span class="sc">+</span> defense <span class="sc">+</span> s_attack <span class="sc">+</span> s_defense <span class="sc">+</span> speed, <span class="at">data =</span> slda_theta, <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">metric =</span> <span class="st">"ROC"</span>, <span class="at">trControl =</span> cv)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Store Models in a List</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>model_list_thetas_sm_stats <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">grass =</span> grass_model_thetas_sm_stats,</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">fire =</span> fire_model_thetas_sm_stats,</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">water =</span> water_model_thetas_sm_stats,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">normal =</span> normal_model_thetas_sm_stats,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">electric =</span> electric_model_thetas_sm_stats,</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">ice =</span> ice_model_thetas_sm_stats,</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">fighting =</span> fighting_model_thetas_sm_stats,</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">poison =</span> poison_model_thetas_sm_stats,</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">ground =</span> ground_model_thetas_sm_stats,</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">flying =</span> flying_model_thetas_sm_stats,</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">psychic =</span> psychic_model_thetas_sm_stats,</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">bug =</span> bug_model_thetas_sm_stats,</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">rock =</span> rock_model_thetas_sm_stats,</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">ghost =</span> ghost_model_thetas_sm_stats,</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">dragon =</span> dragon_model_thetas_sm_stats,</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">dark =</span> dark_model_thetas_sm_stats,</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">steel =</span> steel_model_thetas_sm_stats,</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">fairy =</span> fairy_model_thetas_sm_stats</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an Empty Data Frame to Store Results</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>theta_sm_stats_model_metrics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop Through Each Model</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (type <span class="cf">in</span> <span class="fu">names</span>(model_list_thetas_sm_stats)) {</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> model_list_thetas_sm_stats[[type]]</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get Best Tuning Parameters</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>  best_mtry <span class="ot">&lt;-</span> model<span class="sc">$</span>bestTune<span class="sc">$</span>mtry</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>  preds_best <span class="ot">&lt;-</span> model<span class="sc">$</span>pred <span class="sc">|&gt;</span> <span class="fu">filter</span>(mtry <span class="sc">==</span> best_mtry)</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Confusion Matrix</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>  cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(preds_best<span class="sc">$</span>pred, preds_best<span class="sc">$</span>obs, <span class="at">positive =</span> <span class="st">"yes"</span>)</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract metrics</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>  theta_sm_stats_model_metrics <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(theta_sm_stats_model_metrics, <span class="fu">data.frame</span>(</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> type,</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">sensitivity =</span> cm<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>],</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">specificity =</span> cm<span class="sc">$</span>byClass[<span class="st">"Specificity"</span>],</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">predictors =</span> <span class="st">"thetas_string_matching_and_stats"</span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lastly, we arrive at the question of, “should we even care about topic modeling at all?”. Why bother with all of this code when I can just give a spreadsheet and a prompt to ChatGPT and ask it predict Pokemon types based on their Pokedex entries? That’s a fair enough point, so I tried that as well with Chat GPT-5 with the following prompt:</p>
<blockquote class="blockquote">
<p>“Please read this spreadsheet. Each row is a Pokémon and contains its Pokédex entry. Based on the info column alone, predict up to 2 likely Pokémon types for each entry. Return a table in spreadsheet form. There should be 18 columns stored as a dummy for each type. Preface each type columns with”llm_” and then the type name.”</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the Spreadsheet Chat GPT Gave Me</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>llm_pokemon <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/Pokemon_LLM_Types.xlsx"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with the Tidy Pokemon Data Set</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>llm_pokemon <span class="ot">&lt;-</span> <span class="fu">full_join</span>(llm_pokemon, tidy_pokemon, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"name"</span>, <span class="st">"info"</span>))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an Empty Data Frame to Store Results</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>llm_metrics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop Through Each Type for Predictive Metrics</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (type <span class="cf">in</span> types) {</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  match_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"llm_"</span>, type)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  true_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"type_"</span>, type)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  true <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(llm_pokemon[[true_col]] <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"yes"</span>, <span class="st">"no"</span>))</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  predicted <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(llm_pokemon[[match_col]] <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"yes"</span>, <span class="st">"no"</span>))</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Confusion Matrix</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(predicted, true, <span class="at">positive =</span> <span class="st">"yes"</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store Metrics</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  llm_metrics <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(llm_metrics, <span class="fu">data.frame</span>(</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> type,</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">sensitivity =</span> cm<span class="sc">$</span>byClass[<span class="st">"Sensitivity"</span>],</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">specificity =</span> cm<span class="sc">$</span>byClass[<span class="st">"Specificity"</span>],</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">predictors =</span> <span class="st">"LLM"</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, with all of these predictions and different strategies merged into a single data frame, let’s see how they fared.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>all_metrics <span class="ot">&lt;-</span> <span class="fu">full_join</span>(string_matching_metrics, theta_model_metrics, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"type"</span>, <span class="st">"sensitivity"</span>, <span class="st">"specificity"</span>, <span class="st">"predictors"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(theta_sm_model_metrics, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"type"</span>, <span class="st">"sensitivity"</span>, <span class="st">"specificity"</span>, <span class="st">"predictors"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(theta_sm_stats_model_metrics, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"type"</span>, <span class="st">"sensitivity"</span>, <span class="st">"specificity"</span>, <span class="st">"predictors"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(theta_30_sm_metrics, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"type"</span>, <span class="st">"sensitivity"</span>, <span class="st">"specificity"</span>, <span class="st">"predictors"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(theta_40_sm_metrics, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"type"</span>, <span class="st">"sensitivity"</span>, <span class="st">"specificity"</span>, <span class="st">"predictors"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(theta_50_sm_metrics, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"type"</span>, <span class="st">"sensitivity"</span>, <span class="st">"specificity"</span>, <span class="st">"predictors"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(llm_metrics, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"type"</span>, <span class="st">"sensitivity"</span>, <span class="st">"specificity"</span>, <span class="st">"predictors"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="results" class="level1">
<h1>Results</h1>
<p>The plot below shows the sensitivity (accurate positive predictions / total positives) for each strategy. Because each type is a separate classification task, the balance between positives and negatives (i.e.&nbsp;“is grass type” vs.&nbsp;“is not grass type”) is heavily skewed towards negatives. In this context, by default, just about any approach you use will be pretty conservative and push predictions towards negatives. As a result, I’m more interested in whether any of my approaches can identify the type a Pokemon <em>is</em> rather than the type a Pokemon <em>is not</em>. Each strategy has 18 dots, one for each type.</p>
<p>And, as you can see, yikes! It’s not looking great. I’d arbitrarily feel alright is the dots were clustered in the 60-80% range, but we are not really observing that here. Furthermore, the methods that were the most technically “complex” by far perform the worst. All three strategies that relied on a machine learning algorithm really struggled to detect positive values. Now, part of this could be explained by a lack of technical complexity regarding these algorithms, but I find it interesting that they still perform so poorly. Likewise, the LLM-generated predictions also perform much worse than the simple classification rules that rely on strings or theta values. But again, similar to the ML-based predictions, the LLM-generated predictions could also be improved with more attention focused in the prompts being given.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>all_metrics<span class="sc">$</span>predictors <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  all_metrics<span class="sc">$</span>predictors,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"LLM"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"thetas_string_matching_and_stats"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"thetas_and_string_matching"</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"thetas_only"</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SLDA_50"</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SLDA_40"</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SLDA_30"</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"string_matching"</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_metrics, <span class="fu">aes</span>(<span class="at">x =</span> sensitivity, <span class="at">y =</span> predictors, <span class="at">fill =</span> predictors)) <span class="sc">+</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add Stacked Dots</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dots</span>(</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">side =</span> <span class="st">"top"</span>,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">scale =</span> <span class="fl">0.6</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">dotsize =</span> <span class="dv">1</span>,</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the Distribution Overlay</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_slab</span>(</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">side =</span> <span class="st">"top"</span>,</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">scale =</span> <span class="fl">0.9</span>,</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Custom Colors and Labels</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">"string_matching"</span> <span class="ot">=</span> <span class="st">"#6a040f"</span>,</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">"thetas_only"</span> <span class="ot">=</span> <span class="st">"#dc2f02"</span>,</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">"thetas_and_string_matching"</span> <span class="ot">=</span> <span class="st">"#dc2f02"</span>,</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">"thetas_string_matching_and_stats"</span> <span class="ot">=</span> <span class="st">"#dc2f02"</span>,</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">"SLDA_30"</span> <span class="ot">=</span> <span class="st">"#f48c06"</span>,</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">"SLDA_40"</span> <span class="ot">=</span> <span class="st">"#f48c06"</span>,</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">"SLDA_50"</span> <span class="ot">=</span> <span class="st">"#f48c06"</span>,</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">"LLM"</span> <span class="ot">=</span> <span class="st">"#ffba08"</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>            <span class="st">"string_matching"</span> <span class="ot">=</span> <span class="st">"String Matching"</span>,</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">"thetas_only"</span> <span class="ot">=</span> <span class="st">"Thetas Only</span><span class="sc">\n</span><span class="st">as Predictors"</span>,</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">"thetas_and_string_matching"</span> <span class="ot">=</span> <span class="st">"Thetas +</span><span class="sc">\n</span><span class="st">String Matching</span><span class="sc">\n</span><span class="st">as Predictors"</span>,</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>            <span class="st">"thetas_string_matching_and_stats"</span> <span class="ot">=</span> <span class="st">"Thetas +</span><span class="sc">\n</span><span class="st">String Matching +</span><span class="sc">\n</span><span class="st">Poke Stats as</span><span class="sc">\n</span><span class="st">Predictors"</span>,</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>            <span class="st">"SLDA_30"</span> <span class="ot">=</span> <span class="st">"30% Theta</span><span class="sc">\n</span><span class="st">Classification</span><span class="sc">\n</span><span class="st">Rule"</span>,</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>            <span class="st">"SLDA_40"</span> <span class="ot">=</span> <span class="st">"40% Theta</span><span class="sc">\n</span><span class="st">Classification</span><span class="sc">\n</span><span class="st">Rule"</span>,</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">"SLDA_50"</span> <span class="ot">=</span> <span class="st">"50% Theta</span><span class="sc">\n</span><span class="st">Classification</span><span class="sc">\n</span><span class="st">Rule"</span>,</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">"LLM"</span> <span class="ot">=</span> <span class="st">"LLM Predictions"</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_discrete</span>(</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>            <span class="st">"string_matching"</span> <span class="ot">=</span> <span class="st">"String Matching"</span>,</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>            <span class="st">"thetas_only"</span> <span class="ot">=</span> <span class="st">"Thetas Only</span><span class="sc">\n</span><span class="st">as Predictors"</span>,</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>            <span class="st">"thetas_and_string_matching"</span> <span class="ot">=</span> <span class="st">"Thetas +</span><span class="sc">\n</span><span class="st">String Matching</span><span class="sc">\n</span><span class="st">as Predictors"</span>,</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>            <span class="st">"thetas_string_matching_and_stats"</span> <span class="ot">=</span> <span class="st">"Thetas +</span><span class="sc">\n</span><span class="st">String Matching +</span><span class="sc">\n</span><span class="st">Poke Stats as</span><span class="sc">\n</span><span class="st">Predictors"</span>,</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">"SLDA_30"</span> <span class="ot">=</span> <span class="st">"30% Theta</span><span class="sc">\n</span><span class="st">Classification</span><span class="sc">\n</span><span class="st">Rule"</span>,</span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">"SLDA_40"</span> <span class="ot">=</span> <span class="st">"40% Theta</span><span class="sc">\n</span><span class="st">Classification</span><span class="sc">\n</span><span class="st">Rule"</span>,</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>            <span class="st">"SLDA_50"</span> <span class="ot">=</span> <span class="st">"50% Theta</span><span class="sc">\n</span><span class="st">Classification</span><span class="sc">\n</span><span class="st">Rule"</span>,</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>            <span class="st">"LLM"</span> <span class="ot">=</span> <span class="st">"LLM Predictions"</span></span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Sensitivity (True Positive Rate)"</span>,</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">""</span></span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">blog_theme</span>() <span class="sc">+</span></span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Predictive Performance of Different Strategies</figcaption>
</figure>
</div>
</div>
</div>
<p>The big takeaway here should not be that the simplest approach is always the best. I think it would be fair to make two inferences based on these results. First, a simple approach can actually perform quite well on its own. However, while the floor for predictive performance may be pretty high, the ceiling might not be as high as more technical approaches. This leads to the second point. If you want to use a more technically complex approach (machine learning) or LLMs, it likely will require a bit of up-front lift to ensure that it performs better than simpler classification strategies. This is probably especially true for this example where the text data that we have for each Pokemon is incredibly sparse. I personally don’t think the results would look like if, for example, we had a page a piece for each Pokemon.</p>
<p>Next, we can evaluate which types each approach was able to predict with higher or lower accuracy. And there’s some neat stuff here. Regardless of the strategy used, some types are much more easy to classify than others. The most prominent examples are the ice, electric, and fire types. I’m not very surprised with this. Personally, while writing out the key terms/seeds, I had a much easier time thinking of these terms when dealing with the “elemental” and less abstract Pokemon types. We have tons of words that we use to describe things like electricity and fire and so it’s easy to find a list of terms that are distinct for those types.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>all_metrics<span class="sc">$</span>predictors <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  all_metrics<span class="sc">$</span>predictors,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">c</span>(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"LLM"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"thetas_string_matching_and_stats"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"thetas_and_string_matching"</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"thetas_only"</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SLDA_50"</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SLDA_40"</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SLDA_30"</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"string_matching"</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_metrics, <span class="fu">aes</span>(<span class="at">x =</span> predictors, <span class="at">y =</span> sensitivity, <span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.25</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Sensitivity"</span>,</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Type"</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"string_matching"</span> <span class="ot">=</span> <span class="st">"String Matching"</span>,</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"thetas_only"</span> <span class="ot">=</span> <span class="st">"Thetas Only</span><span class="sc">\n</span><span class="st">as Predictors"</span>,</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"thetas_and_string_matching"</span> <span class="ot">=</span> <span class="st">"Thetas +</span><span class="sc">\n</span><span class="st">String</span><span class="sc">\n</span><span class="st">Matching</span><span class="sc">\n</span><span class="st">as Predictors"</span>,</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"thetas_string_matching_and_stats"</span> <span class="ot">=</span> <span class="st">"Thetas +</span><span class="sc">\n</span><span class="st">String</span><span class="sc">\n</span><span class="st">Matching +</span><span class="sc">\n</span><span class="st">Poke Stats as</span><span class="sc">\n</span><span class="st">Predictors"</span>,</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SLDA_30"</span> <span class="ot">=</span> <span class="st">"30% Theta</span><span class="sc">\n</span><span class="st">Classification</span><span class="sc">\n</span><span class="st">Rule"</span>,</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SLDA_40"</span> <span class="ot">=</span> <span class="st">"40% Theta</span><span class="sc">\n</span><span class="st">Classification</span><span class="sc">\n</span><span class="st">Rule"</span>,</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SLDA_50"</span> <span class="ot">=</span> <span class="st">"50% Theta</span><span class="sc">\n</span><span class="st">Classification</span><span class="sc">\n</span><span class="st">Rule"</span>,</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"LLM"</span> <span class="ot">=</span> <span class="st">"LLM Predictions"</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_x_discrete</span>(</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"string_matching"</span> <span class="ot">=</span> <span class="st">"String Matching"</span>,</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">"thetas_only"</span> <span class="ot">=</span> <span class="st">"Thetas Only</span><span class="sc">\n</span><span class="st">as Predictors"</span>,</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"thetas_and_string_matching"</span> <span class="ot">=</span> <span class="st">"Thetas +</span><span class="sc">\n</span><span class="st">String</span><span class="sc">\n</span><span class="st">Matching</span><span class="sc">\n</span><span class="st">as Predictors"</span>,</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">"thetas_string_matching_and_stats"</span> <span class="ot">=</span> <span class="st">"Thetas +</span><span class="sc">\n</span><span class="st">String</span><span class="sc">\n</span><span class="st">Matching +</span><span class="sc">\n</span><span class="st">Poke Stats as</span><span class="sc">\n</span><span class="st">Predictors"</span>,</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SLDA_30"</span> <span class="ot">=</span> <span class="st">"30% Theta</span><span class="sc">\n</span><span class="st">Classification</span><span class="sc">\n</span><span class="st">Rule"</span>,</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SLDA_40"</span> <span class="ot">=</span> <span class="st">"40% Theta</span><span class="sc">\n</span><span class="st">Classification</span><span class="sc">\n</span><span class="st">Rule"</span>,</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SLDA_50"</span> <span class="ot">=</span> <span class="st">"50% Theta</span><span class="sc">\n</span><span class="st">Classification</span><span class="sc">\n</span><span class="st">Rule"</span>,</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">"LLM"</span> <span class="ot">=</span> <span class="st">"LLM Predictions"</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> type_colors,   </span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> type_names    </span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">blog_theme</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Predictive Performance of Different Strategies by Pokemon Type</figcaption>
</figure>
</div>
</div>
</div>
<p>But what about the types that are much more abstract? Like fairy, dragon, and normal? As you can see, and as expected, a lot of the approaches used really struggled to classify these types correctly. After all, what makes a fairy-type Pokemon <em>fairy-type</em>? What about normal types? For normal types in particular, what really makes them <em>normal</em> is just the <em>absence</em> of any elemental or magical powers. A type being defined in <em>negative</em> terms is one that is really hard to classify, at least when solely using the information (Pokedex entries) for this analysis.</p>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Overall, can you reliably predict a Pokemon’s type by using information from its Pokedex entries (and, in some cases, its statistics)? Not really. Or at least, not at a casual glance. Further, much like all other things data science-y, your results will only be as good as your data. Likewise, as your data worsens, either in scope or quality, “simpler” strategies are not always the least desired.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/brian-lookabaugh\.github\.io\/website-brianlookabaugh\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>